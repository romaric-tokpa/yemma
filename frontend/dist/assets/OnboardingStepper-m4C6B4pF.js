const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-Bd1eNdjl.js","assets/index-M6LqCihd.css"])))=>i.map(i=>d[i]);
import{j as e,r as L,_ as ae,c as A,f as xe,u as Xe,a as Ke,h as _e,b as Qe}from"./index-Bd1eNdjl.js";import{o as W,b as le,n as ee,s as T,a as Q,c as we,d as Se,e as Ce,i as Ee,l as es,f as ss,C as de,u as ts,t as as}from"./types-CJyCLGw2.js";import{c as is,B as R}from"./button-Cfi6qWk1.js";import{P as rs}from"./progress-C-7ezWuE.js";import{C as ge}from"./checkbox-DQnaICfT.js";import{L as v}from"./label-BICZXqY8.js";import{I as C}from"./input-DwpJleoY.js";import{T as ns}from"./textarea-BjsEwAVw.js";import{U as Ne,R as Pe,P as me}from"./rich-text-editor-Tex_oLYo.js";import{X as ue}from"./x-B_t5kLQA.js";import{C as ie}from"./check-circle-2-r2BLfain.js";import{S as De}from"./save-DE3I5MPV.js";import{T as pe}from"./trash-2-B43oMnen.js";import{F as he}from"./file-text-o-2KK-oD.js";import{B as K}from"./badge-CKCgmU0y.js";import{U as cs}from"./users-Ch1n4tQU.js";import{L as ve}from"./loader-2-BEdRIelc.js";import{A as ye}from"./alert-circle-BPADnhac.js";import{C as te,d as re,b as ne,a as ce}from"./card-D8cCDksx.js";import{U as Ae}from"./user-D8cJp9Fd.js";import{P as oe}from"./pen-square-C1yuSSP7.js";import{B as Ve}from"./briefcase-Beq9Z6Yq.js";import{G as Me}from"./graduation-cap-BVV_CcFo.js";import{A as Fe,C as os}from"./code-Jk_TOSFu.js";import{M as ls}from"./map-pin-BWoTEm0l.js";import{Z as ds}from"./zap-BfnaRRis.js";import{F as ms}from"./file-Bo9GkILU.js";import{S as us}from"./search-DjXQ_vnH.js";import{A as ps}from"./arrow-left-BavPWyJQ.js";import{A as hs}from"./arrow-right-FP9O86po.js";import"./index-S7YbMYag.js";import"./index-C9botiCn.js";import"./check-Bi3mZu60.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xs=is("CheckSquare",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]),Re=W({acceptCGU:le().refine(s=>s===!0,{message:"Vous devez accepter les Conditions Générales d'Utilisation"}),acceptRGPD:le().refine(s=>s===!0,{message:"Vous devez accepter le traitement des données personnelles"}),acceptVerification:le().refine(s=>s===!0,{message:"Vous devez autoriser la vérification des informations"})}),Ue=W({firstName:T().min(2,"Le prénom doit contenir au moins 2 caractères"),lastName:T().min(2,"Le nom doit contenir au moins 2 caractères"),dateOfBirth:T().min(1,"La date de naissance est requise"),nationality:T().min(1,"La nationalité est requise"),email:T().email("Email invalide"),phone:T().min(10,"Le numéro de téléphone est invalide"),address:T().min(5,"L'adresse est requise"),city:T().min(2,"La ville est requise"),country:T().min(2,"Le pays est requis"),profileTitle:T().min(5,"Le titre du profil doit contenir au moins 5 caractères"),professionalSummary:T().min(300,"Le résumé professionnel doit contenir au moins 300 caractères"),sector:T().min(1,"Le secteur d'activité est requis"),mainJob:T().min(2,"Le métier principal est requis"),totalExperience:ee().min(0,"L'expérience totale doit être positive")}),fs=W({companyName:T().min(2,"Le nom de l'entreprise est requis"),position:T().min(2,"Le poste est requis"),startDate:T().min(1,"La date de début est requise"),endDate:T().optional(),isCurrent:le().default(!1),description:T().min(10,"La description doit contenir au moins 10 caractères"),achievements:T().optional(),hasDocument:le().default(!1)}),$e=W({experiences:Q(fs).min(1,"Au moins une expérience est requise")}),js=W({diploma:T().min(2,"Le diplôme est requis"),institution:T().min(2,"L'établissement est requis"),country:T().optional(),startYear:ee().optional(),graduationYear:ee().min(1900,"L'année d'obtention est invalide"),level:T().min(1,"Le niveau est requis")}),Oe=W({educations:Q(js).min(1,"Au moins une formation est requise")}),gs=W({title:T().min(2,"Le titre de la certification est requis"),issuer:T().min(2,"L'organisme délivreur est requis"),year:ee().min(1900,"L'année est invalide"),expirationDate:T().optional(),verificationUrl:T().url().optional().or(es("")),certificationId:T().optional()}),ze=W({certifications:Q(gs).optional().default([])}),vs=W({name:T().min(2,"Le nom de la compétence est requis"),level:ss(["BEGINNER","INTERMEDIATE","ADVANCED","EXPERT"]),yearsOfPractice:ee().min(0).optional()}),Ie=W({technicalSkills:Q(vs).min(1,"Au moins une compétence technique est requise"),softSkills:Q(T()).optional().default([]),tools:Q(W({name:T(),level:T()})).optional().default([])}),Ge=W({cv:we([Ee(File).refine(s=>s.size<=10*1024*1024,{message:"Le CV ne doit pas dépasser 10MB"}),Se(),Ce()]).optional(),additionalDocuments:we([Q(Ee(File)),Se(),Ce()]).optional().default([]),cv_document_id:ee().optional(),additional_document_ids:Q(ee()).optional()}),qe=W({desiredPositions:Q(T()).min(1,"Au moins un poste recherché est requis").max(5,"Maximum 5 postes"),contractType:T().min(1,"Le type de contrat est requis"),targetSectors:Q(T()).optional().default([]),desiredLocation:T().min(2,"La localisation souhaitée est requise"),mobility:T().optional(),availability:T().min(1,"La disponibilité est requise"),salaryMin:ee().min(0,"Le salaire minimum doit être positif"),salaryMax:ee().min(0,"Le salaire maximum doit être positif")}).refine(s=>s.salaryMin&&s.salaryMax?s.salaryMax>=s.salaryMin:!0,{message:"Le salaire maximum doit être supérieur ou égal au salaire minimum",path:["salaryMax"]});W({step0:Re,step1:Ue,step2:$e,step3:Oe,step4:ze,step5:Ie,step6:Ge,step7:qe});function Be(s){return{accept_cgu:s.acceptCGU||s.acceptCgu||!1,accept_rgpd:s.acceptRGPD||s.acceptRgpd||!1,accept_verification:s.acceptVerification||!1}}function Je(s){const u={};return s.firstName&&(u.first_name=s.firstName),s.lastName&&(u.last_name=s.lastName),s.phone&&(u.phone=s.phone),s.dateOfBirth&&(s.dateOfBirth.includes("T")?u.date_of_birth=s.dateOfBirth:u.date_of_birth=`${s.dateOfBirth}T00:00:00`),s.nationality&&(u.nationality=s.nationality),s.address&&(u.address=s.address),s.city&&(u.city=s.city),s.country&&(u.country=s.country),s.profileTitle&&(u.profile_title=s.profileTitle),s.professionalSummary&&(u.professional_summary=s.professionalSummary),s.sector&&(u.sector=s.sector),s.mainJob&&(u.main_job=s.mainJob),s.totalExperience!==void 0&&s.totalExperience!==null&&(u.total_experience=s.totalExperience),s.photoUrl!==void 0&&s.photoUrl!==null&&s.photoUrl!==""&&(u.photo_url=s.photoUrl),u}function be(s){return(s.experiences||[]).filter(l=>l.companyName&&l.position&&l.startDate).map(l=>{const E={company_name:l.companyName,position:l.position,is_current:l.isCurrent||!1,has_document:l.hasDocument||!1};l.startDate&&l.startDate.trim()!==""&&(l.startDate.includes("T")?!l.startDate.includes("Z")&&!l.startDate.match(/[+-]\d{2}:\d{2}$/)?E.start_date=l.startDate.endsWith("Z")?l.startDate:`${l.startDate}Z`:E.start_date=l.startDate:E.start_date=`${l.startDate}T00:00:00Z`);const d=l.isCurrent||!1,f=l.endDate?l.endDate.trim():"";return d||f!==""&&(f.includes("T")?!f.includes("Z")&&!f.match(/[+-]\d{2}:\d{2}$/)?E.end_date=f.endsWith("Z")?f:`${f}Z`:E.end_date=f:E.end_date=`${f}T00:00:00Z`),l.companyLogoUrl&&(E.company_logo_url=l.companyLogoUrl),l.companySector&&(E.company_sector=l.companySector),l.contractType&&(E.contract_type=l.contractType),l.description!==void 0&&l.description!==null&&l.description!==""&&(E.description=l.description),l.achievements!==void 0&&l.achievements!==null&&l.achievements!==""&&(E.achievements=l.achievements),l.documentId!==void 0&&l.documentId!==null&&(E.document_id=l.documentId),E})}function He(s){return(s.educations||[]).map(l=>({diploma:l.diploma||"",institution:l.institution||"",country:l.country,start_year:l.startYear,graduation_year:l.graduationYear||0,level:l.level||""}))}function Ye(s){return(s.certifications||[]).map(l=>{const E={title:l.title||"",issuer:l.issuer||"",year:l.year||0};return l.expirationDate&&(l.expirationDate.includes("T")?E.expiration_date=l.expirationDate:E.expiration_date=`${l.expirationDate}T00:00:00`),l.verificationUrl&&(E.verification_url=l.verificationUrl),l.certificationId&&(E.certification_id=l.certificationId),E})}function Ze(s){const u=[],l=s.technicalSkills||[];for(const f of l)u.push({skill_type:"TECHNICAL",name:f.name||"",level:f.level||"BEGINNER",years_of_practice:f.yearsOfPractice||0});const E=s.softSkills||[];for(const f of E)u.push({skill_type:"SOFT",name:f,level:null,years_of_practice:null});const d=s.tools||[];for(const f of d)u.push({skill_type:"TOOL",name:f.name||"",level:f.level||null,years_of_practice:null});return u}function We(s){return{desired_positions:(s.desiredPositions||[]).slice(0,5),contract_type:s.contractType,target_sectors:s.targetSectors||[],desired_location:s.desiredLocation,mobility:s.mobility,availability:s.availability,salary_min:s.salaryMin||null,salary_max:s.salaryMax||null,salary_expectations:s.salaryMin&&s.salaryMax?(s.salaryMin+s.salaryMax)/2:s.salaryMin||s.salaryMax||null}}function fe(s){const u={};u.step0={acceptCGU:s.accept_cgu||!1,acceptRGPD:s.accept_rgpd||!1,acceptVerification:s.accept_verification||!1},u.step1={firstName:s.first_name||"",lastName:s.last_name||"",email:s.email||"",phone:s.phone||"",dateOfBirth:s.date_of_birth?new Date(s.date_of_birth).toISOString().split("T")[0]:"",nationality:s.nationality||"",address:s.address||"",city:s.city||"",country:s.country||"",profileTitle:s.profile_title||"",professionalSummary:s.professional_summary||"",sector:s.sector||"",mainJob:s.main_job||"",totalExperience:s.total_experience||0,photoUrl:s.photo_url||null},u.step2={experiences:(s.experiences||[]).map(i=>({id:i.id,companyName:i.company_name||"",companyLogoUrl:i.company_logo_url||null,companySector:i.company_sector||"",position:i.position||"",contractType:i.contract_type||"",startDate:i.start_date?new Date(i.start_date).toISOString().split("T")[0]:"",endDate:i.end_date?new Date(i.end_date).toISOString().split("T")[0]:"",isCurrent:i.is_current||!1,description:i.description||"",achievements:i.achievements||"",hasDocument:i.has_document||!1,documentId:i.document_id||null}))},u.step3={educations:(s.educations||[]).map(i=>({id:i.id,diploma:i.diploma||"",institution:i.institution||"",country:i.country||"",startYear:i.start_year||null,graduationYear:i.graduation_year||new Date().getFullYear(),level:i.level||""}))},u.step4={certifications:(s.certifications||[]).map(i=>({id:i.id,title:i.title||"",issuer:i.issuer||"",year:i.year||new Date().getFullYear(),expirationDate:i.expiration_date?new Date(i.expiration_date).toISOString().split("T")[0]:"",verificationUrl:i.verification_url||"",certificationId:i.certification_id||""}))};const l=s.skills||[],E=l.filter(i=>i.skill_type==="TECHNICAL").map(i=>({id:i.id,name:i.name||"",level:i.level||"BEGINNER",yearsOfPractice:i.years_of_practice||0})),d=l.filter(i=>i.skill_type==="SOFT").map(i=>i.name),f=l.filter(i=>i.skill_type==="TOOL").map(i=>({name:i.name||"",level:i.level||""}));return u.step5={technicalSkills:E,softSkills:d,tools:f},s.job_preferences?(u.step7={desiredPositions:s.job_preferences.desired_positions||[],contractType:s.job_preferences.contract_type||"",targetSectors:s.job_preferences.target_sectors||[],desiredLocation:s.job_preferences.desired_location||"",mobility:s.job_preferences.mobility||"",availability:s.job_preferences.availability||"",salaryMin:s.job_preferences.salary_min||null,salaryMax:s.job_preferences.salary_max||null},!s.job_preferences.salary_min&&!s.job_preferences.salary_max&&s.job_preferences.salary_expectations&&(u.step7.salaryMin=s.job_preferences.salary_expectations,u.step7.salaryMax=s.job_preferences.salary_expectations)):u.step7={desiredPositions:[],contractType:"",targetSectors:[],desiredLocation:"",mobility:"",availability:"",salaryMin:null,salaryMax:null},u.lastStep=s.last_step_completed||0,u.profileId=s.id,u.completionPercentage=s.completion_percentage||0,u}async function ys(s,u,l){const E=Math.max(u.lastStep||0,8),d={...Be(u.step0||{}),...Je(u.step1||{}),last_step_completed:E};await l.updateProfile(s,d);const f=be(u.step2||{});try{const c=await l.getExperiences(s);for(const b of c)await l.deleteExperience(s,b.id)}catch{}for(const c of f)await l.createExperience(s,c);const i=He(u.step3||{});try{const c=await l.getEducations(s);for(const b of c)await l.deleteEducation(s,b.id)}catch{}for(const c of i)await l.createEducation(s,c);const M=Ye(u.step4||{});try{const c=await l.getCertifications(s);for(const b of c)await l.deleteCertification(s,b.id)}catch{}for(const c of M)await l.createCertification(s,c);const h=Ze(u.step5||{technicalSkills:[],softSkills:[],tools:[]});try{const c=await l.getSkills(s);for(const b of c)await l.deleteSkill(s,b.id)}catch{}for(const c of h)await l.createSkill(s,c);const j=We(u.step7||{});await l.updateJobPreferences(s,j),await l.updateProfile(s,{})}function Ns({form:s,onNext:u,isFirstStep:l}){const{handleSubmit:E,formState:{errors:d},control:f}=s;return e.jsx("form",{onSubmit:E(u),className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(de,{name:"acceptCGU",control:f,defaultValue:!1,render:({field:i})=>e.jsx(ge,{id:"acceptCGU",checked:i.value||!1,onCheckedChange:M=>i.onChange(M===!0)})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(v,{htmlFor:"acceptCGU",className:"text-sm font-medium leading-none",children:"J'accepte les Conditions Générales d'Utilisation"}),d.acceptCGU&&e.jsx("p",{className:"text-sm text-destructive",children:d.acceptCGU.message})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(de,{name:"acceptRGPD",control:f,defaultValue:!1,render:({field:i})=>e.jsx(ge,{id:"acceptRGPD",checked:i.value||!1,onCheckedChange:M=>i.onChange(M===!0)})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(v,{htmlFor:"acceptRGPD",className:"text-sm font-medium leading-none",children:"J'accepte le traitement de mes données personnelles (RGPD)"}),d.acceptRGPD&&e.jsx("p",{className:"text-sm text-destructive",children:d.acceptRGPD.message})]})]}),e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(de,{name:"acceptVerification",control:f,defaultValue:!1,render:({field:i})=>e.jsx(ge,{id:"acceptVerification",checked:i.value||!1,onCheckedChange:M=>i.onChange(M===!0)})}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(v,{htmlFor:"acceptVerification",className:"text-sm font-medium leading-none",children:"J'autorise la vérification des informations fournies"}),d.acceptVerification&&e.jsx("p",{className:"text-sm text-destructive",children:d.acceptVerification.message})]})]})]})})}function bs({form:s,onNext:u,onPrevious:l,isFirstStep:E,profileId:d,formData:f}){const{register:i,handleSubmit:M,formState:{errors:h},watch:j,setValue:c}=s,[b,g]=L.useState(null),[S,O]=L.useState(j("photoUrl")||null),[z,B]=L.useState(!1);L.useEffect(()=>{(async()=>{if(d)try{const{candidateApi:V}=await ae(async()=>{const{candidateApi:Z}=await import("./index-Bd1eNdjl.js").then(N=>N.v);return{candidateApi:Z}},__vite__mapDeps([0,1])),q=await V.getMyProfile();q.photo_url?(O(q.photo_url),c("photoUrl",q.photo_url)):(O(null),c("photoUrl",null))}catch(V){console.error("Erreur lors du chargement de la photo:",V)}})()},[d,c]);const G=async $=>{var q,Z,N;const V=(q=$.target.files)==null?void 0:q[0];if(!(!V||!d)){if(!V.type.startsWith("image/")){alert("Veuillez sélectionner une image (JPG, PNG)");return}if(V.size>5*1024*1024){alert("La photo ne doit pas dépasser 5MB");return}try{B(!0);const{documentApi:n,candidateApi:a}=await ae(async()=>{const{documentApi:r,candidateApi:t}=await import("./index-Bd1eNdjl.js").then(m=>m.v);return{documentApi:r,candidateApi:t}},__vite__mapDeps([0,1])),o=await n.uploadProfilePhoto(V,d);let p=o.serve_url;(p&&p.startsWith("/")||o.id)&&(p=n.getDocumentServeUrl(o.id)),await a.updateProfile(d,{photo_url:p}),g(null),O(p),c("photoUrl",p)}catch(n){console.error("Erreur lors de l'upload de la photo:",n),alert("Erreur lors de l'upload de la photo: "+(((N=(Z=n.response)==null?void 0:Z.data)==null?void 0:N.detail)||n.message)),g(null)}finally{B(!1)}}},y=($,V)=>{const q=`${($==null?void 0:$[0])||""}${(V==null?void 0:V[0])||""}`.toUpperCase()||"U";return`https://ui-avatars.com/api/?name=${encodeURIComponent(q)}&size=200&background=random&color=fff&bold=true`},_=j("firstName")||"",U=j("lastName")||"",H=y(_,U),F=S||b||H;return e.jsxs("form",{onSubmit:M(u),className:"space-y-6",children:[e.jsx("div",{className:"border rounded-lg p-4 bg-muted/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:F,alt:"Photo de profil",className:"w-16 h-16 rounded-lg object-cover border-2 border-primary",onError:$=>{$.target.src!==H&&($.target.src=H)}}),z&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-lg",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})})]})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(v,{htmlFor:"photo",className:"text-sm font-medium",children:"Photo de profil (facultative)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{id:"photo",type:"file",accept:"image/jpeg,image/png,image/jpg",onChange:G,disabled:z,className:"hidden"}),e.jsxs(R,{type:"button",variant:"outline",size:"sm",onClick:()=>{var $;return($=document.getElementById("photo"))==null?void 0:$.click()},disabled:z,children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),S||b?"Changer":"Télécharger"]}),(S||b)&&e.jsx(R,{type:"button",variant:"ghost",size:"sm",onClick:()=>{g(null),O(null),c("photoUrl",null),S&&d&&ae(async()=>{const{candidateApi:$}=await import("./index-Bd1eNdjl.js").then(V=>V.v);return{candidateApi:$}},__vite__mapDeps([0,1])).then(({candidateApi:$})=>{$.updateProfile(d,{photo_url:null}).catch(console.error)})},children:e.jsx(ue,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Formats: JPG, PNG (max 5MB). Si non renseigné, un avatar sera généré."})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"firstName",children:"Prénom *"}),e.jsx(C,{id:"firstName",...i("firstName")}),h.firstName&&e.jsx("p",{className:"text-sm text-destructive",children:h.firstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"lastName",children:"Nom *"}),e.jsx(C,{id:"lastName",...i("lastName")}),h.lastName&&e.jsx("p",{className:"text-sm text-destructive",children:h.lastName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"dateOfBirth",children:"Date de naissance *"}),e.jsx(C,{id:"dateOfBirth",type:"date",...i("dateOfBirth")}),h.dateOfBirth&&e.jsx("p",{className:"text-sm text-destructive",children:h.dateOfBirth.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"nationality",children:"Nationalité *"}),e.jsx(C,{id:"nationality",...i("nationality")}),h.nationality&&e.jsx("p",{className:"text-sm text-destructive",children:h.nationality.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"email",children:"Email *"}),e.jsx(C,{id:"email",type:"email",...i("email")}),h.email&&e.jsx("p",{className:"text-sm text-destructive",children:h.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"phone",children:"Téléphone *"}),e.jsx(C,{id:"phone",type:"tel",...i("phone")}),h.phone&&e.jsx("p",{className:"text-sm text-destructive",children:h.phone.message})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(v,{htmlFor:"address",children:"Adresse / Ville *"}),e.jsx(C,{id:"address",...i("address")}),h.address&&e.jsx("p",{className:"text-sm text-destructive",children:h.address.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"city",children:"Ville *"}),e.jsx(C,{id:"city",...i("city")}),h.city&&e.jsx("p",{className:"text-sm text-destructive",children:h.city.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"country",children:"Pays *"}),e.jsx(C,{id:"country",...i("country")}),h.country&&e.jsx("p",{className:"text-sm text-destructive",children:h.country.message})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(v,{htmlFor:"profileTitle",children:"Titre du profil *"}),e.jsx(C,{id:"profileTitle",...i("profileTitle")}),h.profileTitle&&e.jsx("p",{className:"text-sm text-destructive",children:h.profileTitle.message})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(v,{htmlFor:"professionalSummary",children:"Résumé professionnel (min. 300 caractères) *"}),e.jsx(ns,{id:"professionalSummary",rows:5,...i("professionalSummary")}),h.professionalSummary&&e.jsx("p",{className:"text-sm text-destructive",children:h.professionalSummary.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"sector",children:"Secteur(s) d'activité *"}),e.jsx(C,{id:"sector",...i("sector")}),h.sector&&e.jsx("p",{className:"text-sm text-destructive",children:h.sector.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"mainJob",children:"Métier principal *"}),e.jsx(C,{id:"mainJob",...i("mainJob")}),h.mainJob&&e.jsx("p",{className:"text-sm text-destructive",children:h.mainJob.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"totalExperience",children:"Années d'expérience totale *"}),e.jsx(C,{id:"totalExperience",type:"number",min:"0",...i("totalExperience",{valueAsNumber:!0})}),h.totalExperience&&e.jsx("p",{className:"text-sm text-destructive",children:h.totalExperience.message})]})]})]})}function _s({form:s,onNext:u,onPrevious:l,isFirstStep:E,profileId:d}){const{register:f,handleSubmit:i,formState:{errors:M},watch:h,setValue:j}=s,c=h("experiences")||[],[b,g]=L.useState({}),[S,O]=L.useState({}),[z,B]=L.useState({}),[G,y]=L.useState(new Set),_=()=>{const N=[...c,{companyName:"",companyLogoUrl:null,position:"",startDate:"",endDate:"",isCurrent:!1,description:"",achievements:"",hasDocument:!1,documentId:null}];j("experiences",N)},U=async N=>{var o;const n=c[N];if(n!=null&&n.id&&d)try{await A.deleteExperience(d,n.id)}catch(p){((o=p.response)==null?void 0:o.status)!==404&&console.error("Erreur lors de la suppression de l'expérience:",p)}const a=c.filter((p,r)=>r!==N);j("experiences",a),y(p=>{const r=new Set(p);return r.delete(N),r})},H=async N=>{var a,o,p;const n=c[N];if(!(!n||!d)){if(!n.companyName||!n.position||!n.startDate||!n.description){alert("Veuillez remplir tous les champs obligatoires (Nom de l'entreprise, Poste, Date de début, Description)");return}if(!n.isCurrent&&!n.endDate){alert('Veuillez renseigner une date de fin ou cocher "En cours"');return}try{B(t=>({...t,[N]:!0}));const r=be({experiences:[n]})[0];if(n.id){try{await A.deleteExperience(d,n.id)}catch(w){if(((a=w.response)==null?void 0:a.status)!==404)throw w;console.log("Experience déjà supprimée, création d'une nouvelle")}const t=await A.createExperience(d,r),m=[...c];m[N]={...n,id:t.id},j("experiences",m)}else{const t=await A.createExperience(d,r),m=[...c];m[N]={...n,id:t.id},j("experiences",m)}y(t=>new Set([...t,N])),setTimeout(()=>{y(t=>{const m=new Set(t);return m.delete(N),m})},3e3)}catch(r){console.error("Erreur lors de la sauvegarde de l'expérience:",r),alert("Erreur lors de la sauvegarde: "+(((p=(o=r.response)==null?void 0:o.data)==null?void 0:p.detail)||r.message))}finally{B(r=>({...r,[N]:!1}))}}},F=N=>{const n=N?N.split(" ").map(a=>a[0]).join("").toUpperCase().slice(0,2):"CO";return`https://ui-avatars.com/api/?name=${encodeURIComponent(n)}&size=100&background=random&color=fff&bold=true&format=svg`},$=async(N,n)=>{var o,p,r;const a=(o=N.target.files)==null?void 0:o[0];if(!(!a||!d)){if(!a.type.startsWith("image/")){alert("Veuillez sélectionner une image (JPG, PNG)");return}if(a.size>2*1024*1024){alert("Le logo ne doit pas dépasser 2MB");return}try{g(D=>({...D,[n]:!0}));const{documentApi:t}=await ae(async()=>{const{documentApi:D}=await import("./index-Bd1eNdjl.js").then(k=>k.v);return{documentApi:D}},__vite__mapDeps([0,1])),m=await t.uploadDocument(a,d,"COMPANY_LOGO"),w=t.getDocumentServeUrl(m.id),x=[...c];x[n].companyLogoUrl=w,j("experiences",x)}catch(t){console.error("Erreur lors de l'upload du logo:",t),alert("Erreur lors de l'upload du logo: "+(((r=(p=t.response)==null?void 0:p.data)==null?void 0:r.detail)||t.message))}finally{g(t=>({...t,[n]:!1}))}}},V=async(N,n)=>{var o,p,r;const a=(o=N.target.files)==null?void 0:o[0];if(!(!a||!d)){if(a.size>10*1024*1024){alert("Le document ne doit pas dépasser 10MB");return}try{O(k=>({...k,[n]:!0}));const t=a.name.toLowerCase();let m="OTHER";t.includes("attestation")||t.includes("certificat")?m="ATTESTATION":t.includes("recommandation")||t.includes("lettre")?m="RECOMMENDATION_LETTER":t.includes("contrat")&&(m="OTHER");const{documentApi:w}=await ae(async()=>{const{documentApi:k}=await import("./index-Bd1eNdjl.js").then(P=>P.v);return{documentApi:k}},__vite__mapDeps([0,1])),x=await w.uploadDocument(a,d,m),D=[...c];D[n].documentId=x.id,D[n].hasDocument=!0,j("experiences",D)}catch(t){console.error("Erreur lors de l'upload du document:",t),alert("Erreur lors de l'upload du document: "+(((r=(p=t.response)==null?void 0:p.data)==null?void 0:r.detail)||t.message))}finally{O(t=>({...t,[n]:!1}))}}},q=()=>{for(let N=0;N<c.length;N++){const n=c[N];if(!n.companyName||!n.position||!n.startDate||!n.description)return`L'expérience ${N+1} est incomplète. Veuillez remplir tous les champs obligatoires.`;if(!n.isCurrent&&!n.endDate)return`L'expérience ${N+1} : la date de fin est obligatoire si l'expérience n'est pas en cours.`}return!0},Z=async N=>{const n=q();if(n!==!0){alert(n);return}u(N)};return e.jsxs("form",{onSubmit:i(Z),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[c.map((N,n)=>{var a,o,p,r,t,m,w,x,D,k;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"font-medium",children:["Expérience ",n+1]}),G.has(n)&&e.jsxs("span",{className:"text-xs text-[#226D68] flex items-center gap-1",children:[e.jsx(ie,{className:"w-3 h-3"}),"Sauvegardée"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(R,{type:"button",variant:"default",size:"sm",onClick:()=>H(n),disabled:z[n],children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),z[n]?"Sauvegarde...":"Sauvegarder"]}),c.length>1&&e.jsx(R,{type:"button",variant:"destructive",size:"sm",onClick:()=>U(n),children:e.jsx(pe,{className:"w-4 h-4"})})]})]}),e.jsx("div",{className:"border rounded-lg p-4 bg-muted/50",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:((a=c[n])==null?void 0:a.companyLogoUrl)||F(((o=c[n])==null?void 0:o.companyName)||""),alt:`Logo ${((p=c[n])==null?void 0:p.companyName)||"entreprise"}`,className:"w-16 h-16 rounded-lg object-cover border-2 border-primary",onError:P=>{var I;P.target.src=F(((I=c[n])==null?void 0:I.companyName)||"")}}),b[n]&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-lg",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-white"})})]})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(v,{htmlFor:`logo-${n}`,className:"text-sm font-medium",children:"Logo de l'entreprise (facultatif)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{id:`logo-${n}`,type:"file",accept:"image/jpeg,image/png,image/jpg",onChange:P=>$(P,n),disabled:b[n],className:"hidden"}),e.jsxs(R,{type:"button",variant:"outline",size:"sm",onClick:()=>{var P;return(P=document.getElementById(`logo-${n}`))==null?void 0:P.click()},disabled:b[n],children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),(r=c[n])!=null&&r.companyLogoUrl?"Changer":"Télécharger"]}),((t=c[n])==null?void 0:t.companyLogoUrl)&&e.jsx(R,{type:"button",variant:"ghost",size:"sm",onClick:()=>{const P=[...c];P[n].companyLogoUrl=null,j("experiences",P)},children:e.jsx(ue,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Formats: JPG, PNG (max 2MB). Si non renseigné, un avatar sera généré."})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Nom de l'entreprise *"}),e.jsx(C,{...f(`experiences.${n}.companyName`),onChange:P=>{const I=[...c];I[n].companyName=P.target.value,j("experiences",I)}})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Poste occupé *"}),e.jsx(C,{...f(`experiences.${n}.position`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Date de début *"}),e.jsx(C,{type:"date",...f(`experiences.${n}.startDate`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(v,{children:["Date de fin",h(`experiences.${n}.isCurrent`)?"":" *"]}),e.jsx(C,{type:"date",...f(`experiences.${n}.endDate`),disabled:h(`experiences.${n}.isCurrent`)}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ge,{id:`isCurrent-${n}`,checked:h(`experiences.${n}.isCurrent`)||!1,onCheckedChange:P=>{const I=[...c];I[n].isCurrent=P||!1,P&&(I[n].endDate=""),j("experiences",I)}}),e.jsx(v,{htmlFor:`isCurrent-${n}`,className:"text-sm cursor-pointer",children:"En cours"})]}),!h(`experiences.${n}.isCurrent`)&&!h(`experiences.${n}.endDate`)&&e.jsx("p",{className:"text-xs text-red-600",children:"La date de fin est obligatoire si l'expérience n'est pas en cours"})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(v,{children:"Description des missions *"}),e.jsx(Pe,{value:((m=c[n])==null?void 0:m.description)||"",onChange:P=>{const I=[...c];I[n].description=P,j("experiences",I)},placeholder:"Décrivez vos missions et responsabilités..."})]}),e.jsxs("div",{className:"space-y-2 col-span-2",children:[e.jsx(v,{children:"Réalisations majeures"}),e.jsx(Pe,{value:((w=c[n])==null?void 0:w.achievements)||"",onChange:P=>{const I=[...c];I[n].achievements=P,j("experiences",I)},placeholder:"Listez vos réalisations et accomplissements..."})]}),e.jsx("div",{className:"space-y-2 col-span-2 border rounded-lg p-4 bg-muted/30",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:e.jsx(he,{className:"w-5 h-5 text-muted-foreground"})}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(v,{htmlFor:`document-${n}`,className:"text-sm font-medium",children:"Document justificatif (facultatif)"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Attestation, certificat de travail, lettre de recommandation, contrat, etc. (PDF, JPG, PNG - max 10MB)"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{id:`document-${n}`,type:"file",accept:".pdf,.jpg,.jpeg,.png",onChange:P=>V(P,n),disabled:S[n],className:"hidden"}),e.jsxs(R,{type:"button",variant:"outline",size:"sm",onClick:()=>{var P;return(P=document.getElementById(`document-${n}`))==null?void 0:P.click()},disabled:S[n],children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),S[n]?"Upload en cours...":(x=c[n])!=null&&x.documentId?"Changer le document":"Télécharger un document"]}),((D=c[n])==null?void 0:D.documentId)&&e.jsxs(R,{type:"button",variant:"ghost",size:"sm",onClick:async()=>{try{const{documentApi:P}=await ae(async()=>{const{documentApi:se}=await import("./index-Bd1eNdjl.js").then(Y=>Y.v);return{documentApi:se}},__vite__mapDeps([0,1]));await P.deleteDocument(c[n].documentId);const I=[...c];I[n].documentId=null,I[n].hasDocument=!1,j("experiences",I)}catch(P){console.error("Erreur lors de la suppression:",P)}},children:[e.jsx(ue,{className:"w-4 h-4 mr-2"}),"Supprimer"]})]}),((k=c[n])==null?void 0:k.documentId)&&e.jsxs("p",{className:"text-xs text-[#226D68] flex items-center gap-1",children:[e.jsx(he,{className:"w-3 h-3"}),"Document téléchargé avec succès"]})]})]})})]})]},n)}),e.jsxs(R,{type:"button",variant:"outline",onClick:_,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Ajouter une expérience"]})]}),M.experiences&&e.jsx("p",{className:"text-sm text-destructive",children:M.experiences.message})]})}function ws({form:s,onNext:u,onPrevious:l,isFirstStep:E}){const{register:d,handleSubmit:f,formState:{errors:i},watch:M,setValue:h}=s,j=M("educations")||[],c=()=>{const g=[...j,{diploma:"",institution:"",country:"",startYear:"",graduationYear:new Date().getFullYear(),level:""}];h("educations",g)},b=g=>{const S=j.filter((O,z)=>z!==g);h("educations",S)};return e.jsxs("form",{onSubmit:f(u),className:"space-y-6",children:[e.jsxs("div",{className:"space-y-6",children:[j.map((g,S)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-medium",children:["Formation ",S+1]}),j.length>1&&e.jsx(R,{type:"button",variant:"destructive",size:"sm",onClick:()=>b(S),children:e.jsx(pe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Intitulé du diplôme / formation *"}),e.jsx(C,{...d(`educations.${S}.diploma`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Établissement *"}),e.jsx(C,{...d(`educations.${S}.institution`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Pays"}),e.jsx(C,{...d(`educations.${S}.country`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Année de début"}),e.jsx(C,{type:"number",...d(`educations.${S}.startYear`,{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Année d'obtention *"}),e.jsx(C,{type:"number",...d(`educations.${S}.graduationYear`,{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Niveau *"}),e.jsx(C,{...d(`educations.${S}.level`),placeholder:"Bac, Bac+2, Bac+5, etc."})]})]})]},S)),e.jsxs(R,{type:"button",variant:"outline",onClick:c,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Ajouter une formation"]})]}),i.educations&&e.jsx("p",{className:"text-sm text-destructive",children:i.educations.message})]})}function Ss({form:s,onNext:u,onPrevious:l,isFirstStep:E}){const{register:d,handleSubmit:f,watch:i,setValue:M}=s,h=i("certifications")||[],j=()=>{const b=[...h,{title:"",issuer:"",year:new Date().getFullYear(),expirationDate:"",verificationUrl:"",certificationId:""}];M("certifications",b)},c=b=>{const g=h.filter((S,O)=>O!==b);M("certifications",g)};return e.jsx("form",{onSubmit:f(u),className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[h.map((b,g)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h3",{className:"font-medium",children:["Certification ",g+1]}),e.jsx(R,{type:"button",variant:"destructive",size:"sm",onClick:()=>c(g),children:e.jsx(pe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Intitulé de la certification *"}),e.jsx(C,{...d(`certifications.${g}.title`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Organisme délivreur *"}),e.jsx(C,{...d(`certifications.${g}.issuer`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Année d'obtention *"}),e.jsx(C,{type:"number",...d(`certifications.${g}.year`,{valueAsNumber:!0})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Date d'expiration"}),e.jsx(C,{type:"date",...d(`certifications.${g}.expirationDate`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"URL de vérification"}),e.jsx(C,{type:"url",...d(`certifications.${g}.verificationUrl`)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"ID de la certification"}),e.jsx(C,{...d(`certifications.${g}.certificationId`)})]})]})]},g)),e.jsxs(R,{type:"button",variant:"outline",onClick:j,children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Ajouter une certification"]})]})})}function Cs({form:s,onNext:u,onPrevious:l,isFirstStep:E}){const{register:d,handleSubmit:f,watch:i,setValue:M}=s,h=i("technicalSkills")||[],j=i("softSkills")||[],[c,b]=L.useState(""),g=()=>{const _=[...h,{name:"",level:"BEGINNER",yearsOfPractice:0}];M("technicalSkills",_)},S=_=>{const U=h.filter((H,F)=>F!==_);M("technicalSkills",U)},O=()=>{if(c.trim()&&!j.includes(c.trim())){const _=[...j,c.trim()];M("softSkills",_),b("")}},z=_=>{const U=j.filter((H,F)=>F!==_);M("softSkills",U)},B=_=>{_.key==="Enter"&&(_.preventDefault(),O())},G=["Communication","Leadership","Travail en équipe","Gestion du temps","Résolution de problèmes","Adaptabilité","Créativité","Empathie","Organisation","Motivation","Persévérance","Esprit critique","Négociation","Prise de décision","Gestion du stress","Autonomie"],y=_=>{if(!j.includes(_)){const U=[...j,_];M("softSkills",U)}};return e.jsx("form",{onSubmit:f(u),className:"space-y-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium mb-4 text-base sm:text-lg",children:"Compétences techniques"}),e.jsxs("div",{className:"space-y-4",children:[h.map((_,U)=>e.jsxs("div",{className:"border rounded-lg p-3 sm:p-4 space-y-3 sm:space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h4",{className:"font-medium text-sm sm:text-base",children:["Compétence ",U+1]}),h.length>1&&e.jsx(R,{type:"button",variant:"destructive",size:"sm",onClick:()=>S(U),className:"h-8 w-8 p-0",children:e.jsx(pe,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{className:"text-xs sm:text-sm",children:"Compétence *"}),e.jsx(C,{...d(`technicalSkills.${U}.name`),className:"text-sm sm:text-base",placeholder:"Ex: Python, React..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{className:"text-xs sm:text-sm",children:"Niveau *"}),e.jsxs("select",{className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",...d(`technicalSkills.${U}.level`),children:[e.jsx("option",{value:"BEGINNER",children:"Débutant"}),e.jsx("option",{value:"INTERMEDIATE",children:"Intermédiaire"}),e.jsx("option",{value:"ADVANCED",children:"Avancé"}),e.jsx("option",{value:"EXPERT",children:"Expert"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{className:"text-xs sm:text-sm",children:"Années de pratique"}),e.jsx(C,{type:"number",min:"0",className:"text-sm sm:text-base",...d(`technicalSkills.${U}.yearsOfPractice`,{valueAsNumber:!0})})]})]})]},U)),e.jsxs(R,{type:"button",variant:"outline",onClick:g,className:"w-full sm:w-auto text-xs sm:text-sm",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Ajouter une compétence technique"]})]})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(cs,{className:"w-5 h-5 text-[#226D68]"}),e.jsx("h3",{className:"font-medium text-base sm:text-lg",children:"Compétences comportementales (Soft Skills)"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(C,{value:c,onChange:_=>b(_.target.value),onKeyPress:B,placeholder:"Ajouter une compétence comportementale...",className:"flex-1 text-sm sm:text-base"}),e.jsxs(R,{type:"button",variant:"outline",onClick:O,disabled:!c.trim()||j.includes(c.trim()),className:"w-full sm:w-auto text-xs sm:text-sm",children:[e.jsx(me,{className:"w-4 h-4 mr-2"}),"Ajouter"]})]}),e.jsxs("div",{children:[e.jsx(v,{className:"text-xs sm:text-sm text-muted-foreground mb-2 block",children:"Suggestions courantes :"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:G.map(_=>e.jsxs(K,{variant:j.includes(_)?"default":"outline",className:"cursor-pointer hover:bg-[#226D68]/10 transition-colors text-xs sm:text-sm",onClick:()=>y(_),children:[_,j.includes(_)&&e.jsx("span",{className:"ml-1",children:"✓"})]},_))})]}),j.length>0&&e.jsxs("div",{children:[e.jsxs(v,{className:"text-xs sm:text-sm font-medium mb-2 block",children:["Vos compétences comportementales (",j.length,") :"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:j.map((_,U)=>e.jsxs(K,{variant:"default",className:"bg-[#226D68]/10 text-[#226D68] border-[#226D68]/20 text-xs sm:text-sm px-3 py-1.5 flex items-center gap-2",children:[_,e.jsx("button",{type:"button",onClick:()=>z(U),className:"ml-1 hover:text-red-600 transition-colors","aria-label":`Supprimer ${_}`,children:e.jsx(pe,{className:"w-3 h-3"})})]},U))})]}),j.length===0&&e.jsx("p",{className:"text-xs sm:text-sm text-muted-foreground italic",children:"Aucune compétence comportementale ajoutée. Cliquez sur les suggestions ci-dessus ou ajoutez-en une manuellement."})]})]})]})})}function Es({form:s,onNext:u,onPrevious:l,isFirstStep:E,profileId:d,setFormData:f}){const{control:i,handleSubmit:M,formState:{errors:h},watch:j,setValue:c}=s,b=j("cv"),g=j("additionalDocuments"),[S,O]=L.useState(!1),[z,B]=L.useState(!1),[G,y]=L.useState(null),[_,U]=L.useState([]),[H,F]=L.useState({}),[$,V]=L.useState({}),q=a=>{var o;if(!a||typeof a!="object")return!1;if(typeof a.name=="string"&&typeof a.size=="number"&&typeof a.type=="string")try{return a instanceof File||a instanceof Blob||((o=a.constructor)==null?void 0:o.name)==="File"}catch{return!0}return!1},Z=async a=>{var o,p;if(!(!a||!d)){if(!q(a)){console.warn("CV invalide ignoré:",a);return}if(a.size>10*1024*1024){F(r=>({...r,cv:"Le fichier ne doit pas dépasser 10MB"}));return}O(!0),F(r=>({...r,cv:null})),V(r=>({...r,cv:!1}));try{if(G)try{await xe.deleteDocument(G)}catch(t){console.warn("Erreur lors de la suppression de l'ancien CV:",t)}const r=await xe.uploadDocument(a,d,"CV");y(r.id),V(t=>({...t,cv:!0})),f&&f(t=>({...t,step6:{...t.step6,cv_document_id:r.id,cv:void 0}})),console.log("CV sauvegardé avec succès:",r.id)}catch(r){console.error("Erreur lors de l'upload du CV:",r);const t=((p=(o=r.response)==null?void 0:o.data)==null?void 0:p.detail)||r.message||"Erreur lors de l'upload du CV";F(m=>({...m,cv:t})),c("cv",null)}finally{O(!1)}}},N=async a=>{var t,m;if(!d)return;if(B(!0),F(w=>({...w,additionalDocuments:null})),V(w=>({...w,additionalDocuments:!1})),!a||a.length===0){B(!1);return}const o=Array.from(a).filter(w=>q(w));if(o.length===0){B(!1);return}const p=[],r=[];try{for(const x of o){if(x.size>10*1024*1024){r.push(`${x.name}: Le fichier ne doit pas dépasser 10MB`);continue}try{const D=x.name.toLowerCase().includes("attestation")?"ATTESTATION":x.name.toLowerCase().includes("certificat")?"CERTIFICATE":x.name.toLowerCase().includes("recommandation")?"RECOMMENDATION_LETTER":"OTHER",k=await xe.uploadDocument(x,d,D);p.push(k.id),console.log(`Document ${x.name} sauvegardé avec succès:`,k.id)}catch(D){console.error(`Erreur lors de l'upload de ${x.name}:`,D);const k=((m=(t=D.response)==null?void 0:t.data)==null?void 0:m.detail)||D.message||`Erreur lors de l'upload de ${x.name}`;r.push(`${x.name}: ${k}`)}}const w=[..._,...p];U(w),r.length>0?F(x=>({...x,additionalDocuments:r.join(", ")})):V(x=>({...x,additionalDocuments:!0})),f&&f(x=>({...x,step6:{...x.step6,additional_document_ids:w,additionalDocuments:a}}))}catch(w){console.error("Erreur lors de l'upload des documents:",w),F(x=>({...x,additionalDocuments:"Erreur lors de l'upload des documents"}))}finally{B(!1)}};L.useEffect(()=>{(async()=>{if(d)try{const o=await xe.getCandidateDocuments(d),p=o.find(t=>t.document_type==="CV"&&!t.deleted_at);p&&(y(p.id),V(t=>({...t,cv:!0})),f&&f(t=>({...t,step6:{...t.step6,cv_document_id:p.id}})));const r=o.filter(t=>t.document_type!=="CV"&&t.document_type!=="PROFILE_PHOTO"&&!t.deleted_at);if(r.length>0){const t=r.map(m=>m.id);U(t),V(m=>({...m,additionalDocuments:!0})),f&&f(m=>({...m,step6:{...m.step6,additional_document_ids:t}}))}}catch(o){console.warn("Erreur lors du chargement des documents existants:",o)}})()},[d,f]);const n=async a=>{!G&&!a.cv||u()};return e.jsx("form",{onSubmit:M(n),className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"cv",children:"CV (PDF - obligatoire) *"}),e.jsx(de,{name:"cv",control:i,rules:{validate:a=>G||a&&q(a)?!0:"Le CV est obligatoire"},render:({field:{onChange:a,value:o,...p}})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{id:"cv",type:"file",accept:".pdf",disabled:S,onChange:r=>{var m;const t=(m=r.target.files)==null?void 0:m[0];t&&(a(t),Z(t))},...p,value:void 0}),S&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ve,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Sauvegarde du CV en cours..."})]}),$.cv&&!S&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-[#226D68]",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsx("span",{children:"CV sauvegardé avec succès"})]}),H.cv&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{children:H.cv}),e.jsx("button",{type:"button",onClick:()=>F(r=>({...r,cv:null})),className:"ml-auto",children:e.jsx(ue,{className:"h-4 w-4"})})]})]})}),G&&!S&&!b&&e.jsx("p",{className:"text-sm text-[#226D68]",children:"CV déjà sauvegardé. Vous pouvez le remplacer en sélectionnant un nouveau fichier."}),b&&!S&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Fichier sélectionné: ",b.name]}),h.cv&&e.jsx("p",{className:"text-sm text-destructive",children:h.cv.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"additionalDocuments",children:"Documents complémentaires (optionnel)"}),e.jsx(de,{name:"additionalDocuments",control:i,render:({field:{onChange:a,value:o,...p}})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{id:"additionalDocuments",type:"file",accept:".pdf,.jpg,.jpeg,.png",multiple:!0,disabled:z,onChange:r=>{const t=r.target.files?Array.from(r.target.files):[];a(t),N(t)},...p,value:void 0}),z&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.jsx(ve,{className:"h-4 w-4 animate-spin"}),e.jsx("span",{children:"Sauvegarde des documents en cours..."})]}),$.additionalDocuments&&!z&&_.length>0&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-[#226D68]",children:[e.jsx(ie,{className:"h-4 w-4"}),e.jsxs("span",{children:[_.length," document(s) sauvegardé(s) avec succès"]})]}),H.additionalDocuments&&e.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-600",children:[e.jsx(ye,{className:"h-4 w-4"}),e.jsx("span",{className:"flex-1",children:H.additionalDocuments}),e.jsx("button",{type:"button",onClick:()=>F(r=>({...r,additionalDocuments:null})),children:e.jsx(ue,{className:"h-4 w-4"})})]})]})}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Formats autorisés: PDF, JPG, PNG (max 10MB par fichier)"}),g&&g.length>0&&!z&&e.jsxs("p",{className:"text-sm text-muted-foreground",children:[g.length," fichier(s) sélectionné(s)"]})]})]})})}function Ps({form:s,onNext:u,onPrevious:l,isFirstStep:E}){const{register:d,handleSubmit:f,formState:{errors:i},watch:M,setValue:h}=s,j=M("desiredPositions")||[],c=()=>{const g=[...j,""];h("desiredPositions",g)},b=g=>{const S=j.filter((O,z)=>z!==g);h("desiredPositions",S)};return e.jsx("form",{onSubmit:f(u),className:"space-y-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Poste(s) recherché(s) * (max 5)"}),j.map((g,S)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx(C,{...d(`desiredPositions.${S}`)}),j.length>1&&e.jsx(R,{type:"button",variant:"outline",onClick:()=>b(S),children:"Supprimer"})]},S)),j.length<5&&e.jsx(R,{type:"button",variant:"outline",onClick:c,children:"Ajouter un poste"}),i.desiredPositions&&e.jsx("p",{className:"text-sm text-destructive",children:i.desiredPositions.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"contractType",children:"Type de contrat souhaité *"}),e.jsxs("select",{id:"contractType",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",...d("contractType"),children:[e.jsx("option",{value:"",children:"Sélectionner..."}),e.jsx("option",{value:"CDI",children:"CDI"}),e.jsx("option",{value:"CDD",children:"CDD"}),e.jsx("option",{value:"FREELANCE",children:"Freelance"}),e.jsx("option",{value:"STAGE",children:"Stage"}),e.jsx("option",{value:"ALTERNANCE",children:"Alternance"})]}),i.contractType&&e.jsx("p",{className:"text-sm text-destructive",children:i.contractType.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"desiredLocation",children:"Localisation souhaitée *"}),e.jsx(C,{id:"desiredLocation",...d("desiredLocation")}),i.desiredLocation&&e.jsx("p",{className:"text-sm text-destructive",children:i.desiredLocation.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"mobility",children:"Mobilité géographique"}),e.jsx(C,{id:"mobility",...d("mobility")})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{htmlFor:"availability",children:"Disponibilité *"}),e.jsxs("select",{id:"availability",className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm",...d("availability"),children:[e.jsx("option",{value:"",children:"Sélectionner..."}),e.jsx("option",{value:"IMMEDIATE",children:"Immédiate"}),e.jsx("option",{value:"1_MONTH",children:"1 mois"}),e.jsx("option",{value:"2_MONTHS",children:"2 mois"}),e.jsx("option",{value:"3_MONTHS",children:"3 mois"}),e.jsx("option",{value:"MORE",children:"Plus de 3 mois"})]}),i.availability&&e.jsx("p",{className:"text-sm text-destructive",children:i.availability.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(v,{children:"Prétentions salariales * (CFA/mois)"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsx(v,{htmlFor:"salaryMin",className:"text-sm font-normal",children:"Minimum (CFA/mois)"}),e.jsx(C,{id:"salaryMin",type:"number",min:"0",placeholder:"Ex: 250000",...d("salaryMin",{valueAsNumber:!0})}),i.salaryMin&&e.jsx("p",{className:"text-sm text-destructive",children:i.salaryMin.message})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(v,{htmlFor:"salaryMax",className:"text-sm font-normal",children:"Maximum (CFA/mois)"}),e.jsx(C,{id:"salaryMax",type:"number",min:"0",placeholder:"Ex: 500000",...d("salaryMax",{valueAsNumber:!0})}),i.salaryMax&&e.jsx("p",{className:"text-sm text-destructive",children:i.salaryMax.message})]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Indiquez la fourchette salariale mensuelle que vous souhaitez (minimum et maximum)"})]})]})})}const je=s=>{if(!s)return"Non spécifié";try{return new Date(s).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}catch{return s}},ke=s=>s?s.toString():"Non spécifié",ks=s=>({BEGINNER:"Débutant",INTERMEDIATE:"Intermédiaire",ADVANCED:"Avancé",EXPERT:"Expert"})[s]||s,Te=(s,u)=>{const l=`${(s==null?void 0:s[0])||""}${(u==null?void 0:u[0])||""}`.toUpperCase()||"U";return`https://ui-avatars.com/api/?name=${encodeURIComponent(l)}&size=200&background=random&color=fff&bold=true`},Le=s=>{const u=s?s.split(" ").map(l=>l[0]).join("").toUpperCase().slice(0,2):"CO";return`https://ui-avatars.com/api/?name=${encodeURIComponent(u)}&size=100&background=random&color=fff&bold=true&format=svg`};function Ts({formData:s,onSubmit:u,onPrevious:l,isFirstStep:E,onEditStep:d,profileId:f}){const i=s.step1||{},M=s.step2||{},h=s.step3||{},j=s.step4||{},c=s.step5||{},b=s.step6||{},g=s.step7||{},S=M.experiences||[],O=h.educations||[],z=j.certifications||[],B=c.technicalSkills||[],G=c.softSkills||[],y=c.tools||[],[_,U]=L.useState(!1),[H,F]=L.useState(!1),[$,V]=L.useState(0),[q,Z]=L.useState(!0),[N,n]=L.useState(i.photoUrl||null);return L.useEffect(()=>{(async()=>{if(!f){Z(!1);return}try{const{candidateApi:o,documentApi:p}=await ae(async()=>{const{candidateApi:x,documentApi:D}=await import("./index-Bd1eNdjl.js").then(k=>k.v);return{candidateApi:x,documentApi:D}},__vite__mapDeps([0,1])),r=await o.getMyProfile();let t=[];try{t=await p.getCandidateDocuments(f)}catch(x){console.error("Erreur lors de la récupération des documents:",x)}if(r.photo_url)n(r.photo_url);else try{const x=t.filter(D=>D.document_type==="PROFILE_PHOTO"||D.document_type==="OTHER").sort((D,k)=>new Date(k.created_at)-new Date(D.created_at))[0];if(x){const D=await p.getDocumentViewUrl(x.id);n(D.view_url)}}catch(x){console.error("Erreur lors de la récupération de la photo:",x)}const m=t.filter(x=>x.document_type==="CV");U(m.length>0);const w=t.filter(x=>x.document_type!=="CV"&&x.document_type!=="PROFILE_PHOTO"&&x.document_type!=="COMPANY_LOGO"&&x.document_type!=="OTHER");F(w.length>0),V(w.length)}catch(o){console.error("Erreur lors de la vérification des documents:",o);const p=m=>{var w;if(!m||typeof m!="object")return!1;if(typeof m.name=="string"&&typeof m.size=="number"&&typeof m.type=="string")try{return m instanceof File||m instanceof Blob||((w=m.constructor)==null?void 0:w.name)==="File"}catch{return!0}return!1},r=b.cv&&(p(b.cv)||Array.isArray(b.cv)&&b.cv.length>0);U(r||!1);const t=b.additionalDocuments&&Array.isArray(b.additionalDocuments)&&b.additionalDocuments.length>0;F(t||!1),V(t?b.additionalDocuments.length:0)}finally{Z(!1)}})()},[f,b]),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-muted p-4 rounded-lg",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"Récapitulatif de votre profil"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Veuillez vérifier toutes les informations avant de soumettre votre profil pour validation."})]}),e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ae,{className:"w-5 h-5"}),e.jsx(ne,{children:"Profil Général"})]}),d&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>d(1),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Modifier"]})]})}),e.jsxs(ce,{className:"space-y-4",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("img",{src:N||Te(i.firstName,i.lastName),alt:"Photo de profil",className:"w-32 h-32 rounded-full object-cover border-4 border-primary shadow-lg",onError:async a=>{if(N&&(N.includes("X-Amz-Algorithm")||N.includes("localhost:9000")||N.includes("minio")))try{const{documentApi:p,candidateApi:r}=await ae(async()=>{const{documentApi:w,candidateApi:x}=await import("./index-Bd1eNdjl.js").then(D=>D.v);return{documentApi:w,candidateApi:x}},__vite__mapDeps([0,1])),m=(await p.getCandidateDocuments(f)).filter(w=>w.document_type==="OTHER").sort((w,x)=>new Date(x.created_at)-new Date(w.created_at))[0];if(m){const x=(await p.getDocumentViewUrl(m.id)).view_url;await r.updateProfile(f,{photo_url:x}),n(x),a.target.src=x;return}}catch(p){console.error("Erreur lors de la régénération de la photo:",p)}const o=Te(i.firstName,i.lastName);a.target.src=o}})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Nom complet :"}),e.jsxs("p",{children:[i.firstName," ",i.lastName]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Date de naissance :"}),e.jsx("p",{children:je(i.dateOfBirth)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Nationalité :"}),e.jsx("p",{children:i.nationality||"Non spécifié"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Email :"}),e.jsx("p",{children:i.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Téléphone :"}),e.jsx("p",{children:i.phone})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Localisation :"}),e.jsxs("p",{children:[i.city,", ",i.country]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Adresse :"}),e.jsx("p",{children:i.address})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Titre du profil :"}),e.jsx("p",{className:"font-semibold",children:i.profileTitle})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Secteur d'activité :"}),e.jsx("p",{children:i.sector})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Métier principal :"}),e.jsx("p",{children:i.mainJob})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Années d'expérience :"}),e.jsxs("p",{children:[i.totalExperience||0," ans"]})]}),e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Résumé professionnel :"}),e.jsx("p",{className:"mt-1 text-sm",children:i.professionalSummary})]})]})]})]}),e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ve,{className:"w-5 h-5"}),e.jsx(ne,{children:"Expériences Professionnelles"}),e.jsx(K,{variant:"secondary",children:S.length})]}),d&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>d(2),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Modifier"]})]})}),e.jsx(ce,{children:S.length>0?e.jsx("div",{className:"space-y-4",children:S.map((a,o)=>e.jsxs("div",{className:"border-l-2 border-primary pl-4 pb-4 last:pb-0",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("img",{src:a.companyLogoUrl||Le(a.companyName),alt:`Logo ${a.companyName}`,className:"w-16 h-16 rounded-lg object-cover border-2 border-muted shadow-sm",onError:p=>{p.target.src=Le(a.companyName)}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:a.position}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.companyName}),a.companySector&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.companySector})]}),e.jsxs("div",{className:"text-right text-sm text-muted-foreground",children:[e.jsx("p",{children:je(a.startDate)}),e.jsx("p",{children:a.isCurrent?"En cours":je(a.endDate)}),a.contractType&&e.jsx(K,{variant:"outline",className:"mt-1",children:a.contractType})]})]}),a.description&&e.jsx("div",{className:"mt-2 text-sm prose prose-sm max-w-none [&_ul]:list-disc [&_ol]:list-decimal [&_ul]:ml-4 [&_ol]:ml-4 [&_li]:my-1",dangerouslySetInnerHTML:{__html:a.description}}),a.achievements&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Réalisations :"}),e.jsx("div",{className:"text-sm mt-1 prose prose-sm max-w-none [&_ul]:list-disc [&_ol]:list-decimal [&_ul]:ml-4 [&_ol]:ml-4 [&_li]:my-1",dangerouslySetInnerHTML:{__html:a.achievements}})]}),a.hasDocument&&e.jsxs(K,{variant:"secondary",className:"mt-2",children:[e.jsx(he,{className:"w-3 h-3 mr-1"}),"Document justificatif"]})]},o))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucune expérience renseignée"})})]}),e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Me,{className:"w-5 h-5"}),e.jsx(ne,{children:"Formations & Diplômes"}),e.jsx(K,{variant:"secondary",children:O.length})]}),d&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>d(3),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Modifier"]})]})}),e.jsx(ce,{children:O.length>0?e.jsx("div",{className:"space-y-3",children:O.map((a,o)=>e.jsxs("div",{className:"flex items-start justify-between pb-3 border-b last:border-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:a.diploma}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.institution}),a.country&&e.jsx("p",{className:"text-xs text-muted-foreground",children:a.country})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsx(K,{variant:"outline",children:a.level}),e.jsx("p",{className:"text-muted-foreground mt-1",children:ke(a.graduationYear)})]})]},o))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucune formation renseignée"})})]}),e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-5 h-5"}),e.jsx(ne,{children:"Certifications & Attestations"}),e.jsx(K,{variant:"secondary",children:z.length})]}),d&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>d(4),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Modifier"]})]})}),e.jsx(ce,{children:z.length>0?e.jsx("div",{className:"space-y-3",children:z.map((a,o)=>e.jsxs("div",{className:"flex items-start justify-between pb-3 border-b last:border-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold",children:a.title}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.issuer}),a.certificationId&&e.jsxs("p",{className:"text-xs text-muted-foreground",children:["ID: ",a.certificationId]})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsx("p",{className:"text-muted-foreground",children:ke(a.year)}),a.expirationDate&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Expire: ",je(a.expirationDate)]})]})]},o))}):e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucune certification renseignée"})})]}),e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(os,{className:"w-5 h-5"}),e.jsx(ne,{children:"Compétences"})]}),d&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>d(5),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Modifier"]})]})}),e.jsxs(ce,{className:"space-y-4",children:[B.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Compétences techniques"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:B.map((a,o)=>e.jsxs(K,{variant:"default",children:[a.name," - ",ks(a.level),a.yearsOfPractice>0&&` (${a.yearsOfPractice} ans)`]},o))})]}),G.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Compétences comportementales"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:G.map((a,o)=>e.jsx(K,{variant:"secondary",children:a},o))})]}),y.length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Outils & logiciels"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:y.map((a,o)=>e.jsxs(K,{variant:"outline",children:[a.name," ",a.level&&`(${a.level})`]},o))})]}),B.length===0&&G.length===0&&y.length===0&&e.jsx("p",{className:"text-sm text-muted-foreground",children:"Aucune compétence renseignée"})]})]}),e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5"}),e.jsx(ne,{children:"Documents"})]}),d&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>d(6),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Modifier"]})]})}),e.jsx(ce,{children:e.jsxs("div",{className:"space-y-2",children:[q?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"}),e.jsx("span",{className:"text-sm text-muted-foreground",children:"Vérification des documents..."})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[_?e.jsx(ie,{className:"w-4 h-4 text-[#226D68]"}):e.jsx(ye,{className:"w-4 h-4 text-yellow-500"}),e.jsxs("span",{className:"text-sm",children:["CV: ",_?"Téléchargé":"Non téléchargé"]})]}),H&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ie,{className:"w-4 h-4 text-[#226D68]"}),e.jsxs("span",{className:"text-sm",children:["Documents complémentaires: ",$," fichier",$>1?"s":""]})]})]})})]}),e.jsxs(te,{children:[e.jsx(re,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ls,{className:"w-5 h-5"}),e.jsx(ne,{children:"Recherche d'emploi & Préférences"})]}),d&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>d(7),children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Modifier"]})]})}),e.jsx(ce,{children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[g.desiredPositions&&g.desiredPositions.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Poste(s) recherché(s) :"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:g.desiredPositions.map((a,o)=>e.jsx(K,{variant:"outline",children:a},o))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Type de contrat :"}),e.jsx("p",{children:g.contractType||"Non spécifié"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Localisation souhaitée :"}),e.jsx("p",{children:g.desiredLocation||"Non spécifiée"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Mobilité géographique :"}),e.jsx("p",{children:g.mobility||"Non spécifiée"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Disponibilité :"}),e.jsx("p",{children:g.availability||"Non spécifiée"})]}),(g.salaryMin||g.salaryMax)&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Prétentions salariales :"}),e.jsx("p",{children:g.salaryMin&&g.salaryMax?`${g.salaryMin.toLocaleString("fr-FR")} - ${g.salaryMax.toLocaleString("fr-FR")} CFA/mois`:g.salaryMin?`À partir de ${g.salaryMin.toLocaleString("fr-FR")} CFA/mois`:`Jusqu'à ${g.salaryMax.toLocaleString("fr-FR")} CFA/mois`})]}),g.targetSectors&&g.targetSectors.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"font-medium text-muted-foreground",children:"Secteur(s) ciblé(s) :"}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-1",children:g.targetSectors.map((a,o)=>e.jsx(K,{variant:"secondary",children:a},o))})]})]})})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 p-4 rounded-lg flex items-start gap-3",children:[e.jsx(ye,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-yellow-800 mb-1",children:"Information importante"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"Votre profil sera analysé par notre équipe RH avant publication dans la CVthèque. Vous recevrez une notification par email une fois la validation effectuée."})]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-4",children:[!E&&e.jsx(R,{type:"button",variant:"outline",onClick:l,children:"Précédent"}),e.jsxs(R,{onClick:u,className:"ml-auto",size:"lg",children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Soumettre mon profil pour validation"]})]})]})}const X=[{id:0,title:"Conditions & Consentement",icon:he,component:Ns,schema:Re},{id:1,title:"Profil Général",icon:Ae,component:bs,schema:Ue},{id:2,title:"Expériences",icon:Ve,component:_s,schema:$e},{id:3,title:"Formations",icon:Me,component:ws,schema:Oe},{id:4,title:"Certifications",icon:Fe,component:Ss,schema:ze},{id:5,title:"Compétences",icon:ds,component:Cs,schema:Ie},{id:6,title:"Documents",icon:ms,component:Es,schema:Ge},{id:7,title:"Recherche d'emploi",icon:us,component:Ps,schema:qe},{id:8,title:"Récapitulatif",icon:xs,component:Ts,schema:null}];function dt(){const s=Xe(),u=Ke(),[l,E]=L.useState([]),[d,f]=L.useState(!1),[i,M]=L.useState(null),[h,j]=L.useState({}),[c,b]=L.useState(null),[g,S]=L.useState(!0),[O,z]=L.useState(!1),B=L.useRef(null),G=()=>{const a=u.pathname.match(/\/onboarding\/step(\d+)/);if(a){const o=parseInt(a[1],10);if(o>=0&&o<X.length)return o}return 0},y=G(),_=X[y],U=_.component,H=L.useMemo(()=>{if(h.completionPercentage!==void 0&&h.completionPercentage!==null)return h.completionPercentage;const a=l.length,o=h[`step${y}`]&&Object.keys(h[`step${y}`]).length>0,p=l.includes(y);let r=a;return!p&&o&&(r+=.5),Math.min(100,r/X.length*100)},[h.completionPercentage,l,h,y]);L.useEffect(()=>{(async()=>{var o;try{if(S(!0),!localStorage.getItem("auth_token")){s("/login");return}try{const r=await A.getMyProfile();b(r.id);const t=fe(r);j(t);const m=[],w=t.lastStep!==void 0&&t.lastStep!==null?t.lastStep:-1;for(let x=0;x<=w&&x<X.length;x++)m.push(x);if(E(m),!O){const x=G();if(u.pathname==="/onboarding"||x<t.lastStep){const D=t.lastStep!==void 0&&t.lastStep<X.length-1?t.lastStep+1:0;s(`/onboarding/step${D}`,{replace:!0})}else if(x!==G()){const D=t.lastStep!==void 0&&t.lastStep<X.length-1?t.lastStep+1:0;s(`/onboarding/step${D}`,{replace:!0})}z(!0)}}catch(r){if(((o=r.response)==null?void 0:o.status)===404)try{const t=await Qe.getCurrentUser(),m=await A.createProfile({email:t.email,first_name:t.first_name||"",last_name:t.last_name||""});b(m.id),O||(s("/onboarding/step0",{replace:!0}),z(!0))}catch(t){console.error("Erreur lors de la création du profil:",t)}else console.error("Erreur lors du chargement du profil:",r)}}catch(p){console.error("Erreur lors du chargement:",p)}finally{S(!1)}})()},[s,O]);const F=ts({resolver:_.schema?as(_.schema):void 0,defaultValues:{},mode:"onChange"}),$=L.useMemo(()=>{const a=G();return h[`step${a}`]||(a===0?{acceptCGU:!1,acceptRGPD:!1,acceptVerification:!1}:{})},[u.pathname,h]);L.useEffect(()=>{const a=G();B.current!==a&&(B.current=a,F.reset($))},[u.pathname,F,$]);const V=L.useCallback(async(a,o=y)=>{var p;if(!(d||!c))try{if(f(!0),o===0||o===1){const r=o===0?Be(a):Je(a);o===0&&console.log("Sauvegarde des consentements (étape 0):",{frontend_data:a,backend_mapped:r}),await A.updateProfile(c,{...r,last_step_completed:o})}else if(o===2){const r=be({experiences:a.experiences||[]});try{const t=await A.getExperiences(c);for(const m of t)await A.deleteExperience(c,m.id)}catch{}for(const t of r){if(console.log("Création d'expérience avec données:",JSON.stringify(t,null,2)),!t.company_name||!t.position||!t.start_date)throw console.error("Expérience invalide - champs manquants:",{company_name:t.company_name,position:t.position,start_date:t.start_date}),new Error("Expérience invalide: champs obligatoires manquants (company_name, position, start_date)");if(!t.is_current&&!t.end_date)throw console.error("Expérience invalide - date de fin manquante pour expérience terminée:",{company_name:t.company_name,is_current:t.is_current,end_date:t.end_date}),new Error("Expérience invalide: la date de fin est obligatoire si l'expérience n'est pas en cours");const m={...t};m.is_current&&delete m.end_date,await A.createExperience(c,m)}await A.updateProfile(c,{last_step_completed:o})}else if(o===3){const r=He({educations:a.educations||[]});try{const t=await A.getEducations(c);for(const m of t)await A.deleteEducation(c,m.id)}catch{}for(const t of r)await A.createEducation(c,t);await A.updateProfile(c,{last_step_completed:o})}else if(o===4){const r=Ye({certifications:a.certifications||[]});try{const t=await A.getCertifications(c);for(const m of t)await A.deleteCertification(c,m.id)}catch{}for(const t of r)await A.createCertification(c,t);await A.updateProfile(c,{last_step_completed:o})}else if(o===5){const r=Ze(a);try{const t=await A.getSkills(c);for(const m of t)await A.deleteSkill(c,m.id)}catch{}for(const t of r)await A.createSkill(c,t);await A.updateProfile(c,{last_step_completed:o})}else if(o===6){const r=h.step6||{};await A.updateProfile(c,{last_step_completed:o})}else if(o===7){const r=We(a);await A.updateJobPreferences(c,r),await A.updateProfile(c,{last_step_completed:o})}try{const r=await A.getMyProfile(),t=fe(r);j(t);const m=[],w=t.lastStep!==void 0&&t.lastStep!==null?t.lastStep:-1;for(let x=0;x<=w&&x<X.length;x++)m.push(x);E(m)}catch(r){console.error("Erreur lors du rechargement du profil:",r),j(t=>({...t,[`step${o}`]:a,lastStep:o})),E(t=>t.includes(o)?t:[...t,o].sort((m,w)=>m-w))}M(new Date)}catch(r){console.error("Erreur lors de la sauvegarde:",r);const t=(p=r.response)==null?void 0:p.data;let m=r.message;t&&(t.detail?Array.isArray(t.detail)?m=`Erreurs de validation:
${t.detail.map(x=>`${x.loc?x.loc.join("."):"unknown"}: ${x.msg}`).join(`
`)}`:m=t.detail:t.message&&(m=t.message)),alert("Erreur lors de la sauvegarde: "+m)}finally{f(!1)}},[y,c,d]);L.useEffect(()=>{const a=F.watch(p=>{j(r=>({...r,[`step${y}`]:p}))}),o=setInterval(()=>{var r;const p=F.getValues();if(Object.keys(p).length>0)if(y!==6)V(p);else{const t=h.step6||{};(t.cv_document_id||((r=t.additional_document_ids)==null?void 0:r.length)>0)&&A.updateProfile(c,{last_step_completed:6}).catch(m=>{console.warn("Erreur lors de la mise à jour du last_step_completed:",m)})}},3e4);return()=>{a.unsubscribe(),clearInterval(o)}},[F,y,V,h,c]);const q=L.useCallback(async a=>{const o=F.getValues();if(_.schema&&a>y&&!await F.trigger())return console.log("Validation échouée, ne pas changer d'étape"),!1;const p=a>y;if(Object.keys(o).length>0&&c)try{await V(o,y),await new Promise(r=>setTimeout(r,100))}catch(r){console.error("Erreur lors de la sauvegarde:",r)}return p&&E(r=>r.includes(y)?r:[...r,y].sort((t,m)=>t-m)),s(`/onboarding/step${a}`),!0},[y,F,h,_,V,c,s]),Z=async()=>{y<X.length-1&&await q(y+1)},N=()=>{y>0&&q(y-1)},n=async a=>{var o,p,r,t,m,w,x,D;if(!c){alert("Erreur: Profil non trouvé");return}try{f(!0);let k,P;try{k=await A.getMyProfile(),P=fe(k)}catch(J){throw console.error("Erreur lors du rechargement du profil avant soumission:",J),new Error("Impossible de charger le profil depuis le serveur")}const I={...P,...h,[`step${y}`]:a,step0:P.step0||{acceptCGU:!1,acceptRGPD:!1,acceptVerification:!1}},se={acceptCGU:k.accept_cgu===!0,acceptRGPD:k.accept_rgpd===!0,acceptVerification:k.accept_verification===!0};if(console.log("Vérification des consentements avant soumission:",{backend:{accept_cgu:k.accept_cgu,accept_rgpd:k.accept_rgpd,accept_verification:k.accept_verification},computed:se,step0_from_transform:P.step0}),!se.acceptCGU||!se.acceptRGPD||!se.acceptVerification){console.warn("Consentements non acceptés dans le backend:",{accept_cgu:k.accept_cgu,accept_rgpd:k.accept_rgpd,accept_verification:k.accept_verification,types:{accept_cgu_type:typeof k.accept_cgu,accept_rgpd_type:typeof k.accept_rgpd,accept_verification_type:typeof k.accept_verification}}),alert("Vous devez accepter les conditions d'utilisation (CGU, RGPD et vérification) avant de soumettre votre profil. Redirection vers l'étape des consentements..."),s("/onboarding/step0"),f(!1);return}if(y<8&&a){console.log(`Sauvegarde de l'étape ${y} avant soumission...`);try{await V(a,y),await new Promise(J=>setTimeout(J,500))}catch(J){console.warn(`Erreur lors de la sauvegarde de l'étape ${y}:`,J)}}console.log("Sauvegarde complète du profil avant soumission..."),await ys(c,I,A),await new Promise(J=>setTimeout(J,1e3));try{const J=await A.getMyProfile();console.log("Profil rechargé après sauvegarde:",{completion_percentage:J.completion_percentage||"Non calculé",experiences:((o=J.experiences)==null?void 0:o.length)||0,educations:((p=J.educations)==null?void 0:p.length)||0,skills:((r=J.skills)==null?void 0:r.length)||0,job_preferences:J.job_preferences?"Oui":"Non"})}catch(J){console.warn("Erreur lors du rechargement du profil après sauvegarde:",J)}let Y;try{Y=await A.getMyProfile();const J=fe(Y);j(J),console.log("Profil avant soumission:",{completion_percentage:Y.completion_percentage||"Non calculé",accept_cgu:Y.accept_cgu,accept_rgpd:Y.accept_rgpd,accept_verification:Y.accept_verification,experiences:((t=Y.experiences)==null?void 0:t.length)||0,educations:((m=Y.educations)==null?void 0:m.length)||0,skills:((w=Y.skills)==null?void 0:w.length)||0,job_preferences:Y.job_preferences?"Oui":"Non",has_cv:"Vérification en cours..."})}catch(J){console.warn("Erreur lors du rechargement du profil avant soumission:",J),Y=k}await A.submitProfile(c),s("/candidate/dashboard")}catch(k){console.error("Erreur lors de la soumission:",k);let P="Erreur lors de la soumission du profil";(D=(x=k.response)==null?void 0:x.data)!=null&&D.detail?P=k.response.data.detail:k.message&&(P=k.message);const I={"CV PDF":"Un CV PDF est obligatoire. Veuillez télécharger votre CV à l'étape 6 (Documents).",consentements:"Vous devez accepter les conditions d'utilisation (CGU, RGPD et vérification).",prénom:"Le prénom et le nom sont obligatoires. Veuillez compléter l'étape 1 (Profil général).",email:"L'email est obligatoire.","date de naissance":"La date de naissance est obligatoire. Veuillez compléter l'étape 1 (Profil général).",nationalité:"La nationalité est obligatoire. Veuillez compléter l'étape 1 (Profil général).",téléphone:"Le téléphone est obligatoire. Veuillez compléter l'étape 1 (Profil général).",adresse:"L'adresse complète (adresse, ville, pays) est obligatoire. Veuillez compléter l'étape 1 (Profil général).","titre du profil":"Le titre du profil est obligatoire. Veuillez compléter l'étape 1 (Profil général).","résumé professionnel":"Le résumé professionnel (minimum 300 caractères) est obligatoire. Veuillez compléter l'étape 1 (Profil général).",secteur:"Le secteur d'activité est obligatoire. Veuillez compléter l'étape 1 (Profil général).","métier principal":"Le métier principal est obligatoire. Veuillez compléter l'étape 1 (Profil général).",expérience:"Au moins une expérience professionnelle est requise. Veuillez compléter l'étape 2 (Expériences).",formation:"Au moins une formation est requise. Veuillez compléter l'étape 3 (Formations).",compétence:"Au moins une compétence technique est requise. Veuillez compléter l'étape 5 (Compétences).",préférences:"Les préférences de recherche d'emploi sont requises. Veuillez compléter l'étape 7 (Recherche d'emploi).","type de contrat":"Le type de contrat souhaité est obligatoire. Veuillez compléter l'étape 7 (Recherche d'emploi).",localisation:"La localisation souhaitée est obligatoire. Veuillez compléter l'étape 7 (Recherche d'emploi).",disponibilité:"La disponibilité est obligatoire. Veuillez compléter l'étape 7 (Recherche d'emploi).","poste recherché":"Au moins un poste recherché est obligatoire. Veuillez compléter l'étape 7 (Recherche d'emploi).","prétentions salariales":"Les prétentions salariales (min ou max) sont obligatoires. Veuillez compléter l'étape 7 (Recherche d'emploi)."};for(const[se,Y]of Object.entries(I))if(P.toLowerCase().includes(se.toLowerCase())){P=Y;break}alert(`Erreur lors de la soumission:

`+P+`

Veuillez compléter les informations manquantes et réessayer.`)}finally{f(!1)}};return g?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-[#226D68] mx-auto mb-4"}),e.jsx("p",{className:"text-muted-foreground",children:"Chargement de votre profil..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#226D68] to-[#1a5a55] text-white shadow-lg",children:e.jsxs("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-4",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-xl sm:text-2xl md:text-3xl font-bold font-heading mb-1 sm:mb-2",children:"Création de votre profil"}),e.jsx("p",{className:"text-xs sm:text-sm text-white/80",children:"Complétez votre profil pour être visible par les recruteurs"})]}),i&&e.jsxs("div",{className:"flex items-center gap-2 text-xs sm:text-sm text-white/80 flex-shrink-0",children:[e.jsx(De,{className:"h-3.5 w-3.5 sm:h-4 sm:w-4"}),e.jsxs("span",{className:"hidden sm:inline",children:["Dernière sauvegarde: ",i.toLocaleTimeString()]}),e.jsx("span",{className:"sm:hidden",children:i.toLocaleTimeString("fr-FR",{hour:"2-digit",minute:"2-digit"})})]})]}),e.jsxs("div",{className:"mb-3 sm:mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-xs sm:text-sm font-medium",children:["Étape ",y+1," sur ",X.length]}),e.jsxs("span",{className:"text-xs sm:text-sm font-semibold",children:[Math.round(H),"% complété"]})]}),e.jsx(rs,{value:H,className:"h-2 sm:h-3 bg-white/20"})]})]})}),e.jsx("div",{className:"bg-white border-b shadow-sm sticky top-0 z-40",children:e.jsx("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-3 sm:py-4",children:e.jsx("div",{className:"flex justify-between items-center overflow-x-auto pb-2 -mx-3 sm:mx-0 px-3 sm:px-0 scrollbar-hide",children:X.slice(0,8).map((a,o)=>{const p=l.includes(o),r=o===y,t=p||r||o<y;return e.jsxs("button",{onClick:()=>{t&&q(o)},className:`flex flex-col items-center flex-shrink-0 min-w-[60px] sm:min-w-[80px] transition-all duration-200 ${t?"cursor-pointer hover:opacity-80":"cursor-not-allowed opacity-50"}`,children:[e.jsx("div",{className:`w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center border-2 mb-1 sm:mb-2 transition-all duration-200 ${p?"bg-[#226D68] border-[#226D68] text-white shadow-md":r?"bg-[#226D68]/20 border-[#226D68] text-[#226D68] shadow-sm scale-110":"bg-white border-gray-300 text-gray-400"}`,children:p?e.jsx(ie,{className:"w-5 h-5 sm:w-6 sm:h-6"}):_e.createElement(a.icon,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),e.jsx("span",{className:`text-[10px] sm:text-xs text-center font-medium transition-colors leading-tight ${r?"text-[#226D68]":p?"text-gray-700":"text-gray-400"}`,children:a.title.split(" ")[0]})]},a.id)})})})}),e.jsx("div",{className:"container mx-auto px-3 sm:px-4 md:px-6 py-4 sm:py-6 md:py-8 max-w-4xl",children:e.jsxs(te,{className:"rounded-[16px] shadow-lg border-0 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-[#226D68]/5 to-blue-deep/5 p-4 sm:p-6 border-b",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-start gap-3 sm:gap-4",children:[e.jsx("div",{className:"w-12 h-12 sm:w-16 sm:h-16 rounded-full bg-gradient-to-br from-[#226D68] to-blue-deep flex items-center justify-center text-white shadow-md flex-shrink-0",children:_e.createElement(_.icon,{className:"w-6 h-6 sm:w-8 sm:h-8"})}),e.jsxs("div",{className:"text-center sm:text-left flex-1 min-w-0",children:[e.jsx("h2",{className:"text-xl sm:text-2xl font-bold text-gray-anthracite font-heading",children:_.title}),e.jsxs("p",{className:"text-xs sm:text-sm text-muted-foreground mt-1",children:["Étape ",y+1," sur ",X.length]})]})]})}),e.jsx("div",{className:"p-4 sm:p-6 md:p-8",children:e.jsx(U,{form:F,formData:h,setFormData:j,onNext:Z,onPrevious:N,onSubmit:n,onEditStep:q,isLastStep:y===X.length-1,isFirstStep:y===0,profileId:c})}),e.jsxs("div",{className:"bg-gray-50 px-4 sm:px-6 md:px-8 py-3 sm:py-4 border-t flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-3 sm:gap-4",children:[e.jsxs(R,{type:"button",variant:"outline",onClick:N,disabled:y===0||d,className:"border-blue-deep text-blue-deep hover:bg-blue-deep/10 w-full sm:w-auto order-2 sm:order-1",children:[e.jsx(ps,{className:"w-4 h-4 mr-2"}),"Précédent"]}),d&&e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs sm:text-sm text-muted-foreground order-1 sm:order-2",children:[e.jsx(ve,{className:"w-4 h-4 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Sauvegarde en cours..."}),e.jsx("span",{className:"sm:hidden",children:"Sauvegarde..."})]}),y<X.length-1?e.jsxs(R,{type:"button",onClick:Z,disabled:d,className:"bg-[#226D68] hover:bg-[#1a5a55] text-white w-full sm:w-auto order-3",children:["Suivant",e.jsx(hs,{className:"w-4 h-4 ml-2"})]}):e.jsx(R,{type:"button",onClick:F.handleSubmit(n),disabled:d,className:"bg-[#226D68] hover:bg-[#1a5a55] text-white w-full sm:w-auto order-3",children:d?e.jsxs(e.Fragment,{children:[e.jsx(ve,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Soumission..."}),e.jsx("span",{className:"sm:hidden",children:"Soumission..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(ie,{className:"w-4 h-4 mr-2"}),"Soumettre mon profil"]})})]})]})})]})}export{dt as default};
