import{u as z,r as p,j as e,L as f,b as w}from"./index-Bd1eNdjl.js";import{u as A,t as _}from"./types-CJyCLGw2.js";import{B as u}from"./button-Cfi6qWk1.js";import{I as o}from"./input-DwpJleoY.js";import{L as d}from"./label-BICZXqY8.js";import{C as v,b as D,c as E,a as F}from"./card-D8cCDksx.js";import{r as P}from"./auth-BbcWLlDI.js";import{C as U}from"./check-circle-2-r2BLfain.js";import{U as V}from"./users-Ch1n4tQU.js";import{A as M}from"./alert-circle-BPADnhac.js";import{U as T}from"./user-plus-CsBpLbnQ.js";import{A as R}from"./arrow-left-BavPWyJQ.js";import"./index-S7YbMYag.js";function ee(){const y=z(),[c,N]=p.useState(null),[i,g]=p.useState(!1),[C,S]=p.useState(!1),k=A({resolver:_(P),defaultValues:{email:"",password:"",confirmPassword:"",firstName:"",lastName:""}}),{register:l,handleSubmit:I,formState:{errors:t}}=k,L=async r=>{var j,b;try{g(!0),N(null);const a={email:r.email,password:r.password,first_name:r.firstName,last_name:r.lastName,role:"ROLE_CANDIDAT"},s=await w.register(a);if(s.access_token){localStorage.setItem("auth_token",s.access_token),s.refresh_token&&localStorage.setItem("refresh_token",s.refresh_token);const m=await w.getCurrentUser();localStorage.setItem("user",JSON.stringify(m))}S(!0),setTimeout(()=>{y("/onboarding")},2e3)}catch(a){console.error("Erreur d'inscription:",a);let s="Une erreur est survenue lors de l'inscription. Veuillez réessayer.";if(a.response){const m=a.response.status,n=((j=a.response.data)==null?void 0:j.detail)||"";if(m===409)s=n||"Un compte avec cet email existe déjà. Veuillez vous connecter ou utiliser un autre email.";else if(m===400)s=n||"Les données fournies sont invalides. Veuillez vérifier vos informations.";else if(m===422){const x=((b=a.response.data)==null?void 0:b.detail)||[];Array.isArray(x)&&x.length>0?s=x.map(h=>h.msg||h.message||String(h)).join(", "):s=n||"Les données fournies sont invalides."}else m===500?s="Une erreur serveur est survenue. Veuillez réessayer plus tard.":n&&(s=n)}else a.message&&(s=a.message);N(s)}finally{g(!1)}};return C?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white flex items-center justify-center p-3 sm:p-4",children:e.jsx(v,{className:"w-full max-w-md rounded-[16px] shadow-xl border-0 overflow-hidden animate-in fade-in zoom-in",children:e.jsxs("div",{className:"p-4 sm:p-6 text-white text-center",style:{background:"linear-gradient(to right, #226D68, #1a5a55)"},children:[e.jsx(U,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 animate-in zoom-in"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold font-heading mb-2",children:"Inscription réussie !"}),e.jsx("p",{className:"text-sm sm:text-base text-white/80",children:"Votre compte a été créé avec succès. Vous allez être redirigé vers la création de votre profil..."})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white flex items-center justify-center p-3 sm:p-4 md:p-6",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(v,{className:"rounded-[16px] shadow-xl border-0 overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 text-white",style:{background:"linear-gradient(to right, #226D68, #1a5a55)"},children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center flex-shrink-0",children:e.jsx(V,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(D,{className:"text-xl sm:text-2xl font-bold font-heading text-white truncate",children:"Inscription Candidat"}),e.jsx(E,{className:"text-white/80 mt-1 text-xs sm:text-sm",children:"Créez votre compte pour accéder à la plateforme"})]})]})}),e.jsxs(F,{className:"p-4 sm:p-6",children:[e.jsxs("form",{onSubmit:I(L),className:"space-y-4 sm:space-y-5",children:[c&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg animate-in slide-in-from-top-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(M,{className:"w-4 h-4 sm:w-5 sm:h-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium mb-1",children:c}),c.includes("existe déjà")&&e.jsx(f,{to:"/login",className:"text-xs sm:text-sm text-red-700 hover:text-red-900 underline font-medium",children:"Se connecter avec cet email →"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"firstName",className:"text-sm font-semibold",children:"Prénom *"}),e.jsx(o,{id:"firstName",...l("firstName"),disabled:i,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.firstName&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.firstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"lastName",className:"text-sm font-semibold",children:"Nom *"}),e.jsx(o,{id:"lastName",...l("lastName"),disabled:i,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.lastName&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.lastName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"email",className:"text-sm font-semibold",children:"Email *"}),e.jsx(o,{id:"email",type:"email",placeholder:"votre@email.com",...l("email"),disabled:i,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.email&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"password",className:"text-sm font-semibold",children:"Mot de passe *"}),e.jsx(o,{id:"password",type:"password",placeholder:"••••••••",...l("password"),disabled:i,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.password&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.password.message}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Minimum 8 caractères"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(d,{htmlFor:"confirmPassword",className:"text-sm font-semibold",children:"Confirmer le mot de passe *"}),e.jsx(o,{id:"confirmPassword",type:"password",placeholder:"••••••••",...l("confirmPassword"),disabled:i,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.confirmPassword&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.confirmPassword.message})]}),e.jsx(u,{type:"submit",className:"w-full text-white h-11 sm:h-12 text-sm sm:text-base font-semibold transition-all duration-200 shadow-md hover:shadow-lg",style:{backgroundColor:"#226D68"},onMouseEnter:r=>{r.currentTarget.style.backgroundColor="#1a5a55"},onMouseLeave:r=>{r.currentTarget.style.backgroundColor="#226D68"},disabled:i,children:i?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Inscription en cours..."}),e.jsx("span",{className:"sm:hidden",children:"Inscription..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{className:"w-4 h-4 mr-2"}),"Créer mon compte"]})})]}),e.jsxs("div",{className:"mt-5 sm:mt-6 pt-5 sm:pt-6 border-t",children:[e.jsx("p",{className:"text-xs sm:text-sm text-center text-muted-foreground mb-3 sm:mb-4",children:"Vous avez déjà un compte ?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(f,{to:"/login",className:"flex-1",children:e.jsxs(u,{variant:"outline",className:"w-full border-blue-deep text-blue-deep hover:bg-blue-deep/10 h-10 sm:h-11 text-xs sm:text-sm",children:[e.jsx(R,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"}),"Se connecter"]})}),e.jsx(f,{to:"/register/company",className:"flex-1",children:e.jsx(u,{variant:"outline",className:"w-full border-blue-deep text-blue-deep hover:bg-blue-deep/10 h-10 sm:h-11 text-xs sm:text-sm",children:"Entreprise"})})]})]})]})]})})})}export{ee as default};
