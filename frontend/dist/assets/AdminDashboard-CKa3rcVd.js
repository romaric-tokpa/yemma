import{u as Le,r as d,d as pe,p as Pe,j as e,c as W,b as Ve,f as G}from"./index-Bd1eNdjl.js";import{C as h,d as g,b as N,a as p,c as V}from"./card-D8cCDksx.js";import{c as $e,B as o}from"./button-Cfi6qWk1.js";import{B as b}from"./badge-CKCgmU0y.js";import{I as Ue}from"./input-DwpJleoY.js";import{X as ue,S as Be}from"./separator-DQXClfv5.js";import{D as Fe,a as Me,b as ze,c as Oe,d as qe}from"./dialog-BN_5nm6L.js";import{b as He}from"./photoUtils-CtZbZuPZ.js";import{S as Je}from"./shield-i1WdHKph.js";import{X as We}from"./x-B_t5kLQA.js";import{M as Ge}from"./menu-BgKbhLXO.js";import{U as $}from"./user-D8cJp9Fd.js";import{C as fe}from"./clock-Buf-mcQb.js";import{C as Q}from"./check-circle-jNIH7fFd.js";import{B as C}from"./building-CSE3-r45.js";import{C as Qe}from"./chevron-down-BcLpwZNB.js";import{C as Xe}from"./chevron-right-B8yzCsr1.js";import{C as X}from"./credit-card-Bv8Vrikg.js";import{L as Ke}from"./log-out-CTwygceK.js";import{R as U}from"./refresh-cw-C67KWL0F.js";import{S as Ye}from"./search-DjXQ_vnH.js";import{F as Ze}from"./filter-DyHWeMUx.js";import{U as je}from"./users-Ch1n4tQU.js";import{L as K}from"./loader-2-BEdRIelc.js";import{A as es}from"./alert-circle-BPADnhac.js";import{T as ss}from"./trending-up-DkWEozg2.js";import{C as ge}from"./calendar-p8-hsO2I.js";import{E as Ne}from"./eye-BqqZurcw.js";import{B as be}from"./briefcase-Beq9Z6Yq.js";import{M as ye}from"./mail-o8PmpWpn.js";import{P as ve}from"./phone-DTRyLOfC.js";import{M as ts}from"./map-pin-BWoTEm0l.js";import"./index-C9botiCn.js";import"./index-S7YbMYag.js";import"./index-6rAN-zCG.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=$e("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),as=(_,m)=>{const A=`${(_==null?void 0:_[0])||""}${(m==null?void 0:m[0])||""}`.toUpperCase()||"U";return`https://ui-avatars.com/api/?name=${encodeURIComponent(A)}&size=200&background=random&color=fff&bold=true`},rs={DRAFT:"bg-gray-100 text-gray-800 border-gray-200",SUBMITTED:"bg-blue-100 text-blue-800 border-blue-200",IN_REVIEW:"bg-yellow-100 text-yellow-800 border-yellow-200",VALIDATED:"bg-[#D1E9E7] text-[#1a5a55] border-[#B8DDD9]",REJECTED:"bg-red-100 text-red-800 border-red-200",ARCHIVED:"bg-gray-100 text-gray-800 border-gray-200"},B={DRAFT:"Brouillon",SUBMITTED:"Soumis",IN_REVIEW:"En cours de validation",VALIDATED:"Valid√©",REJECTED:"Rejet√©",ARCHIVED:"Archiv√©"};function zs(){var de,me,xe,he;const _=Le(),[m,A]=d.useState(!0),[u,F]=d.useState("candidates"),[T,M]=d.useState(!1),[y,I]=d.useState(null),[we,Z]=d.useState([]),[ee,se]=d.useState(!0),[te,R]=d.useState(null),[j,k]=d.useState("SUBMITTED"),[S,Ee]=d.useState(""),[ae,_e]=d.useState({}),[w,re]=d.useState({DRAFT:0,SUBMITTED:0,IN_REVIEW:0,VALIDATED:0,REJECTED:0,ARCHIVED:0}),[D,De]=d.useState([]),[v,ls]=d.useState(null),[z,le]=d.useState([]),[f,Ce]=d.useState({}),[O,ne]=d.useState(!1),[l,ie]=d.useState(null),q=async()=>{var s;try{try{const t=await W.getProfileStats();if(t&&typeof t=="object"){const i={DRAFT:parseInt(t.DRAFT)||0,SUBMITTED:parseInt(t.SUBMITTED)||0,IN_REVIEW:parseInt(t.IN_REVIEW)||0,VALIDATED:parseInt(t.VALIDATED)||0,REJECTED:parseInt(t.REJECTED)||0,ARCHIVED:parseInt(t.ARCHIVED)||0};re(i),console.log("‚úÖ Statistiques charg√©es depuis l'endpoint /api/v1/profiles/stats:",i);return}}catch(t){console.warn("‚ö†Ô∏è Endpoint /api/v1/profiles/stats non disponible, utilisation du fallback:",((s=t==null?void 0:t.response)==null?void 0:s.data)||(t==null?void 0:t.message))}const n=["DRAFT","SUBMITTED","IN_REVIEW","VALIDATED","REJECTED","ARCHIVED"].map(async t=>{var i;try{const r=await W.listProfiles(t,1,1e4);if(Array.isArray(r)){const E=r.length;return console.log(`üìä ${t}: ${E} profil(s)`),{status:t,count:E}}else if(r&&typeof r=="object"){if(r.items&&Array.isArray(r.items))return typeof r.total=="number"?{status:t,count:r.total}:(console.warn(`‚ö†Ô∏è ${t}: Pas de total disponible, utilisation du nombre d'items retourn√©s (${r.items.length})`),{status:t,count:r.items.length});if(typeof r.total=="number")return{status:t,count:r.total}}return console.warn(`‚ö†Ô∏è ${t}: Format de r√©ponse inattendu:`,r),{status:t,count:0}}catch(r){return console.error(`‚ùå Erreur lors du chargement des stats pour ${t}:`,((i=r==null?void 0:r.response)==null?void 0:i.data)||(r==null?void 0:r.message)),{status:t,count:0}}}),x=await Promise.all(n),c={};x.forEach(({status:t,count:i})=>{c[t]=i}),re(c),console.log("‚úÖ Statistiques calcul√©es c√¥t√© client (fallback):",c)}catch(a){console.error("‚ùå Erreur lors du chargement des statistiques:",a)}},Ae=async s=>{const a={},n=s.filter(c=>!c.photo_url);if(n.length===0)return;console.log(`AdminDashboard: Loading photos for ${n.length} profiles without photo_url`);const x=n.slice(0,20).map(async c=>{try{const i=(await G.getCandidateDocuments(c.id)).filter(r=>(r.document_type==="PROFILE_PHOTO"||r.document_type==="OTHER")&&!r.deleted_at).sort((r,E)=>new Date(E.created_at)-new Date(r.created_at))[0];if(i){const r=G.getDocumentServeUrl(i.id);a[c.id]=r,console.log(`AdminDashboard: Found photo for profile ${c.id}:`,r)}}catch(t){console.warn(`AdminDashboard: Error loading photo for profile ${c.id}:`,t)}});await Promise.all(x),_e(c=>({...c,...a}))},L=async(s="SUBMITTED")=>{var a,n,x,c;try{se(!0),R(null);const t=await W.listProfiles(s,1,100);console.log("AdminDashboard: Profiles response:",t);let i=[];Array.isArray(t)?i=t:t&&t.items&&Array.isArray(t.items)?i=t.items:t&&t.data&&Array.isArray(t.data)&&(i=t.data),console.log("AdminDashboard: Loaded profiles:",i.length,"profiles with status",s),i.forEach(r=>{console.log(`AdminDashboard: Profile ${r.id} - photo_url:`,r.photo_url)}),i.sort((r,E)=>{const ke=r.submitted_at?new Date(r.submitted_at).getTime():0;return(E.submitted_at?new Date(E.submitted_at).getTime():0)-ke}),Z(i),Ae(i).catch(r=>{console.error("Error loading profile photos:",r)})}catch(t){console.error("Erreur lors du chargement des profils:",t),((a=t.response)==null?void 0:a.status)===404||((n=t.response)==null?void 0:n.status)===501?(R("L'endpoint pour lister les profils n'est pas encore disponible."),Z([])):R(((c=(x=t.response)==null?void 0:x.data)==null?void 0:c.detail)||t.message||"Erreur lors du chargement des profils")}finally{se(!1)}};d.useEffect(()=>{q()},[]),d.useEffect(()=>{u==="candidates"?L(j):u==="companies"&&P()},[j,u]);const P=async()=>{var s,a;try{ne(!0);const n=await pe.listCompanies();De(n||[]);const x=(n||[]).map(async i=>{try{const r=await Pe.getSubscription(i.id);return{companyId:i.id,subscription:r}}catch(r){return console.warn(`Erreur lors du chargement de l'abonnement pour l'entreprise ${i.id}:`,r),{companyId:i.id,subscription:null}}}),c=await Promise.all(x),t={};c.forEach(({companyId:i,subscription:r})=>{t[i]=r}),Ce(t)}catch(n){console.error("Erreur lors du chargement des entreprises:",n),R(((a=(s=n.response)==null?void 0:s.data)==null?void 0:a.detail)||n.message||"Erreur lors du chargement des entreprises")}finally{ne(!1)}},Se=async s=>{try{const a=await pe.getTeamMembers(s);le(a||[])}catch(a){console.error("Erreur lors du chargement des recruteurs:",a),le([])}},ce=s=>{s==="companies"?(M(!T),T||(F("companies"),I("list"))):(F(s),M(!1),I(null))},H=s=>{I(s),F("companies"),s==="recruiters"&&v&&Se(v.id)},Te=s=>{_(`/admin/review/${s}`)},Ie=s=>{ie(s)},oe=()=>{ie(null)},Re=()=>{window.confirm("√ätes-vous s√ªr de vouloir vous d√©connecter ?")&&(Ve.logout(),_("/login"))},J=we.filter(s=>{if(!S)return!0;const a=S.toLowerCase(),n=`${s.first_name||""} ${s.last_name||""}`.toLowerCase(),x=(s.email||"").toLowerCase(),c=(s.profile_title||"").toLowerCase();return n.includes(a)||x.includes(a)||c.includes(a)});return(w.SUBMITTED||0)+(w.VALIDATED||0)+(w.REJECTED||0),e.jsxs("div",{className:"h-screen bg-gray-50 flex overflow-hidden max-h-screen",children:[e.jsxs("aside",{className:`
        fixed lg:static inset-y-0 left-0 z-50
        bg-white border-r border-gray-200
        transition-all duration-300 ease-in-out
        ${m?"w-56 translate-x-0":"w-0 -translate-x-full lg:translate-x-0 lg:w-16"}
        flex flex-col
      `,children:[e.jsxs("div",{className:"h-12 border-b border-gray-200 flex items-center justify-between px-3",children:[m&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-7 h-7 bg-gradient-to-br from-blue-600 to-purple-600 rounded-lg flex items-center justify-center",children:e.jsx(Je,{className:"w-4 h-4 text-white"})}),e.jsx("span",{className:"font-bold text-sm",children:"Admin"})]}),e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>A(!m),className:"lg:hidden h-8 w-8",children:m?e.jsx(We,{className:"w-4 h-4"}):e.jsx(Ge,{className:"w-4 h-4"})})]}),e.jsxs("nav",{className:"flex-1 overflow-y-auto p-2 space-y-1",children:[e.jsxs("div",{children:[e.jsxs(o,{variant:u==="candidates"?"default":"ghost",className:"w-full justify-start h-9 text-sm px-2 mb-1",onClick:()=>ce("candidates"),children:[e.jsx($,{className:"w-3.5 h-3.5 mr-2"}),m&&e.jsx("span",{children:"Validation Candidat"})]}),u==="candidates"&&m&&e.jsxs("div",{className:"ml-6 space-y-0.5 mt-1",children:[e.jsxs(o,{variant:j==="SUBMITTED"?"secondary":"ghost",className:"w-full justify-start h-8 text-xs px-2",onClick:()=>k("SUBMITTED"),children:[e.jsx(fe,{className:"w-3 h-3 mr-2"}),"Soumis"]}),e.jsxs(o,{variant:j==="VALIDATED"?"secondary":"ghost",className:"w-full justify-start h-8 text-xs px-2",onClick:()=>k("VALIDATED"),children:[e.jsx(Q,{className:"w-3 h-3 mr-2"}),"Valid√©s"]}),e.jsxs(o,{variant:j==="REJECTED"?"secondary":"ghost",className:"w-full justify-start h-8 text-xs px-2",onClick:()=>k("REJECTED"),children:[e.jsx(ue,{className:"w-3 h-3 mr-2"}),"Rejet√©s"]})]})]}),e.jsx(Be,{className:"my-2"}),e.jsxs("div",{children:[e.jsxs(o,{variant:u==="companies"?"default":"ghost",className:"w-full justify-between h-9 text-sm px-2",onClick:()=>ce("companies"),children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{className:"w-3.5 h-3.5 mr-2"}),m&&e.jsx("span",{children:"Gestion Entreprises"})]}),m&&(T?e.jsx(Qe,{className:"w-3.5 h-3.5"}):e.jsx(Xe,{className:"w-3.5 h-3.5"}))]}),u==="companies"&&T&&m&&e.jsxs("div",{className:"ml-6 space-y-0.5 mt-1",children:[e.jsxs(o,{variant:y==="list"?"secondary":"ghost",className:"w-full justify-start h-8 text-xs px-2",onClick:()=>H("list"),children:[e.jsx(C,{className:"w-3 h-3 mr-2"}),"Liste des entreprises"]}),e.jsxs(o,{variant:y==="recruiters"?"secondary":"ghost",className:"w-full justify-start h-8 text-xs px-2",onClick:()=>H("recruiters"),children:[e.jsx(Y,{className:"w-3 h-3 mr-2"}),"Recruteurs"]}),e.jsxs(o,{variant:y==="subscriptions"?"secondary":"ghost",className:"w-full justify-start h-8 text-xs px-2",onClick:()=>H("subscriptions"),children:[e.jsx(X,{className:"w-3 h-3 mr-2"}),"Abonnements"]})]})]})]}),e.jsx("div",{className:"border-t border-gray-200 p-2",children:e.jsxs(o,{variant:"ghost",className:"w-full justify-start text-red-600 hover:text-red-700 hover:bg-red-50 h-9 text-sm px-2",onClick:Re,children:[e.jsx(Ke,{className:"w-3.5 h-3.5 mr-2"}),m&&e.jsx("span",{children:"D√©connexion"})]})})]}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>A(!1)}),m&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>A(!1)}),e.jsx("main",{className:"flex-1 overflow-y-auto",children:e.jsxs("div",{className:"container mx-auto p-3 sm:p-4 md:p-6 max-w-7xl",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3 sm:gap-4 mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent truncate",children:u==="candidates"?"Validation Candidat":"Gestion des Entreprises"}),e.jsx("p",{className:"text-xs text-muted-foreground mt-0.5",children:u==="candidates"?"G√©rez la validation des profils candidats":y==="list"?"Consultez et g√©rez les entreprises inscrites":y==="recruiters"?"G√©rez les recruteurs des entreprises":"G√©rez les abonnements des entreprises"})]}),e.jsx(o,{variant:"outline",size:"icon",onClick:()=>{u==="candidates"?(q(),L(j)):P()},className:"lg:hidden h-8 w-8 flex-shrink-0",children:e.jsx(U,{className:"w-4 h-4"})})]}),u==="candidates"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-2 sm:gap-3 mb-3",children:[e.jsxs(h,{className:"bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-200",children:[e.jsx(g,{className:"pb-2 pt-3 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{className:"text-xs font-medium text-yellow-900",children:"Soumis"}),e.jsx(fe,{className:"h-4 w-4 text-yellow-600"})]})}),e.jsxs(p,{className:"px-3 pb-3",children:[e.jsx("div",{className:"text-xl font-bold text-yellow-900",children:w.SUBMITTED||0}),e.jsx("p",{className:"text-xs text-yellow-700 mt-0.5",children:"√Ä valider"})]})]}),e.jsxs(h,{className:"bg-gradient-to-br from-[#E8F4F3] to-[#D1E9E7] border-[#B8DDD9]",children:[e.jsx(g,{className:"pb-2 pt-3 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{className:"text-xs font-medium text-[#1a5a55]",children:"Valid√©s"}),e.jsx(Q,{className:"h-4 w-4 text-[#226D68]"})]})}),e.jsxs(p,{className:"px-3 pb-3",children:[e.jsx("div",{className:"text-xl font-bold text-[#1a5a55]",children:w.VALIDATED||0}),e.jsx("p",{className:"text-xs text-[#1a5a55] mt-0.5",children:"Profils approuv√©s"})]})]}),e.jsxs(h,{className:"bg-gradient-to-br from-red-50 to-red-100 border-red-200",children:[e.jsx(g,{className:"pb-2 pt-3 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{className:"text-xs font-medium text-red-900",children:"Rejet√©s"}),e.jsx(ue,{className:"h-4 w-4 text-red-600"})]})}),e.jsxs(p,{className:"px-3 pb-3",children:[e.jsx("div",{className:"text-xl font-bold text-red-900",children:w.REJECTED||0}),e.jsx("p",{className:"text-xs text-red-700 mt-0.5",children:"Profils refus√©s"})]})]})]}),e.jsx(h,{className:"mb-3",children:e.jsx(p,{className:"pt-3 pb-3 px-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 sm:gap-3",children:[e.jsxs("div",{className:"flex-1 relative min-w-0",children:[e.jsx(Ye,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-muted-foreground w-3.5 h-3.5"}),e.jsx(Ue,{placeholder:"Rechercher par nom, email ou titre...",value:S,onChange:s=>Ee(s.target.value),className:"pl-8 h-9 text-xs sm:text-sm"})]}),e.jsx("div",{className:"flex gap-1.5 flex-wrap",children:["SUBMITTED","VALIDATED","REJECTED"].map(s=>e.jsxs(o,{variant:j===s?"default":"outline",size:"sm",onClick:()=>k(s),className:"flex items-center gap-1.5 h-8 text-xs px-2",children:[j===s&&e.jsx(Ze,{className:"w-3 h-3"}),B[s],w[s]>0&&e.jsx(b,{variant:"secondary",className:"ml-0.5 text-xs px-1 py-0 h-4",children:w[s]})]},s))})]})})})]}),u==="companies"&&y==="list"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-3",children:e.jsxs(h,{className:"bg-gradient-to-br from-blue-50 to-blue-100 border-blue-200",children:[e.jsx(g,{className:"pb-2 pt-3 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(N,{className:"text-xs font-medium text-blue-900",children:"Total Entreprises"}),e.jsx(C,{className:"h-4 w-4 text-blue-600"})]})}),e.jsxs(p,{className:"px-3 pb-3",children:[e.jsx("div",{className:"text-xl font-bold text-blue-900",children:D.length}),e.jsx("p",{className:"text-xs text-blue-700 mt-0.5",children:"Entreprises inscrites"})]})]})})]}),u==="candidates"&&e.jsxs(h,{children:[e.jsx(g,{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b py-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(N,{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(je,{className:"w-4 h-4"}),"Profils ",B[j]]}),e.jsx(V,{className:"text-xs mt-0.5",children:ee?"Chargement...":`${J.length} profil(s) trouv√©(s)`})]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:()=>{q(),L(j)},className:"h-7 px-2 text-xs",children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"Actualiser"]})]})}),e.jsx(p,{className:"p-3",children:ee?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(K,{className:"h-6 w-6 animate-spin text-primary"})}):te?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(es,{className:"h-8 w-8 text-destructive mb-2"}),e.jsx("p",{className:"text-sm font-semibold mb-1",children:"Erreur"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:te}),e.jsx(o,{onClick:()=>L(j),size:"sm",className:"h-8",children:"R√©essayer"})]}):J.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx($,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm font-semibold mb-1",children:"Aucun profil trouv√©"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:S?`Aucun profil ne correspond √† "${S}"`:`Aucun profil avec le statut "${B[j]}" n'est disponible.`})]}):e.jsx("div",{className:"space-y-2",children:J.map(s=>{var c;const a=as(s.first_name,s.last_name);let n=He(s.photo_url,G);!n&&ae[s.id]&&(n=ae[s.id]);const x=n||a;return e.jsx(h,{className:"hover:shadow-md transition-all duration-200 border-l-2 border-l-primary/50",children:e.jsx(p,{className:"pt-3 pb-3 px-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-3",children:[e.jsx("div",{className:"flex-shrink-0 self-center sm:self-start",children:e.jsx("img",{src:x,alt:`${s.first_name} ${s.last_name}`,className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full object-cover border-2 border-primary/20 shadow-sm",onError:t=>{t.target.src!==a&&(console.warn("AdminDashboard: Photo failed to load for profile",s.id,"URL was:",t.target.src),t.target.src=a)},onLoad:()=>{n&&!x.includes("ui-avatars.com")&&console.log("AdminDashboard: Photo loaded successfully for profile",s.id,"URL:",x)}},`photo-${s.id}-${n||"default"}`)}),e.jsxs("div",{className:"flex-1 min-w-0 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex flex-wrap items-center gap-2 mb-1",children:[e.jsxs("h3",{className:"text-xs sm:text-sm font-semibold truncate",children:[s.first_name," ",s.last_name]}),e.jsx(b,{className:`${rs[s.status]} text-xs px-1.5 py-0 h-5 flex-shrink-0`,children:B[s.status]}),s.is_verified&&e.jsx(b,{variant:"outline",className:"bg-[#E8F4F3] text-[#1a5a55] border-[#B8DDD9] text-xs px-1.5 py-0 h-5 flex-shrink-0",children:"V√©rifi√©"})]}),e.jsx("p",{className:"text-xs text-muted-foreground mb-1 truncate",children:s.email}),s.profile_title&&e.jsx("p",{className:"text-xs font-medium mb-1 truncate",children:s.profile_title}),e.jsxs("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 text-xs text-muted-foreground",children:[e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(ss,{className:"w-3 h-3 flex-shrink-0"}),((c=s.completion_percentage)==null?void 0:c.toFixed(0))||0,"%"]}),s.submitted_at&&e.jsxs("span",{className:"flex items-center gap-0.5",children:[e.jsx(ge,{className:"w-3 h-3 flex-shrink-0"}),new Date(s.submitted_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})]}),s.admin_score&&e.jsxs("span",{className:"flex items-center gap-0.5 font-semibold text-primary",children:[e.jsx(Q,{className:"w-3 h-3 flex-shrink-0"}),s.admin_score,"/5"]})]})]}),e.jsx("div",{className:"flex items-center gap-1.5 flex-shrink-0 w-full sm:w-auto justify-end sm:justify-start",children:e.jsxs(o,{variant:"default",size:"sm",onClick:()=>Te(s.id),className:"flex items-center gap-1.5 h-8 px-2 text-xs w-full sm:w-auto",children:[e.jsx(Ne,{className:"h-3.5 w-3.5"}),"Voir"]})})]})})},s.id)})})})]}),u==="companies"&&e.jsxs(e.Fragment,{children:[y==="list"&&e.jsxs(h,{children:[e.jsx(g,{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b py-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(N,{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(C,{className:"w-4 h-4"}),"Liste des Entreprises"]}),e.jsx(V,{className:"text-xs mt-0.5",children:O?"Chargement...":`${D.length} entreprise(s) trouv√©e(s)`})]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:P,className:"h-7 px-2 text-xs",children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"Actualiser"]})]})}),e.jsx(p,{className:"p-3",children:O?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(K,{className:"h-6 w-6 animate-spin text-primary"})}):D.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(C,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm font-semibold mb-1",children:"Aucune entreprise trouv√©e"})]}):e.jsx("div",{className:"space-y-2",children:D.map(s=>{const a=f[s.id],n=s.contact_first_name||s.contact_last_name||s.contact_email||s.contact_phone||s.contact_function;return e.jsx(h,{className:`hover:shadow-md transition-all duration-200 border-l-2 ${(v==null?void 0:v.id)===s.id?"border-l-primary bg-primary/5":"border-l-gray-200"}`,children:e.jsx(p,{className:"pt-3 pb-3 px-3",children:e.jsxs("div",{className:"flex items-start justify-between gap-3",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[s.logo_url&&e.jsx("img",{src:s.logo_url,alt:s.name,className:"w-10 h-10 rounded-lg object-cover border border-gray-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"text-sm font-semibold truncate",children:s.name}),(a==null?void 0:a.plan)&&e.jsx(b,{variant:"outline",className:"text-xs flex-shrink-0",children:a.plan.plan_type||"N/A"})]}),e.jsx("p",{className:"text-xs text-muted-foreground truncate mb-2",children:s.legal_id}),n&&e.jsxs("div",{className:"mt-2 pt-2 border-t border-gray-100 space-y-1",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"R√©f√©rent :"}),(s.contact_first_name||s.contact_last_name)&&e.jsxs("p",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx($,{className:"w-3 h-3"}),s.contact_first_name," ",s.contact_last_name]}),s.contact_function&&e.jsxs("p",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),s.contact_function]}),s.contact_email&&e.jsxs("p",{className:"text-xs text-gray-600 flex items-center gap-1 truncate",children:[e.jsx(ye,{className:"w-3 h-3 flex-shrink-0"}),e.jsx("span",{className:"truncate",children:s.contact_email})]}),s.contact_phone&&e.jsxs("p",{className:"text-xs text-gray-600 flex items-center gap-1",children:[e.jsx(ve,{className:"w-3 h-3"}),s.contact_phone]})]})]})]}),e.jsxs(o,{variant:"default",size:"sm",onClick:x=>{x.stopPropagation(),Ie(s)},className:"flex items-center gap-1.5 h-8 px-2 text-xs flex-shrink-0",children:[e.jsx(Ne,{className:"h-3.5 w-3.5"}),"Voir"]})]})})},s.id)})})})]}),y==="recruiters"&&e.jsxs(h,{children:[e.jsx(g,{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b py-2 px-3",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs(N,{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(Y,{className:"w-4 h-4"}),"Recruteurs des Entreprises"]}),e.jsx(V,{className:"text-xs mt-0.5",children:v?`Recruteurs de ${v.name}`:"S√©lectionnez une entreprise dans la liste pour voir ses recruteurs"})]})})}),e.jsx(p,{className:"p-3",children:v?z.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(je,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm font-semibold mb-1",children:"Aucun recruteur trouv√©"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cette entreprise n'a pas encore de recruteurs"})]}):e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"mb-3 p-2 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("p",{className:"text-xs font-semibold text-blue-900 mb-1",children:v.name}),e.jsxs("p",{className:"text-xs text-blue-700",children:[z.length," recruteur(s)"]})]}),z.map(s=>{var a,n;return e.jsx(h,{className:"hover:shadow-md transition-all",children:e.jsx(p,{className:"pt-3 pb-3 px-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-purple-500 flex items-center justify-center text-white font-bold text-sm",children:((a=s.first_name)==null?void 0:a[0])||((n=s.email)==null?void 0:n[0])||"U"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold",children:s.first_name&&s.last_name?`${s.first_name} ${s.last_name}`:s.email}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:s.email}),s.role_in_company&&e.jsx(b,{variant:"secondary",className:"mt-1 text-xs",children:s.role_in_company})]})]})})},s.id||s.user_id)})]}):e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(Y,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm font-semibold mb-1",children:"S√©lectionnez une entreprise"}),e.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:'Allez dans "Liste des entreprises" et cliquez sur une entreprise'}),e.jsx(o,{variant:"outline",size:"sm",onClick:()=>{I("list"),M(!0)},children:"Voir la liste"})]})})]}),y==="subscriptions"&&e.jsxs(h,{children:[e.jsx(g,{className:"bg-gradient-to-r from-gray-50 to-gray-100 border-b py-2 px-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs(N,{className:"flex items-center gap-1.5 text-sm",children:[e.jsx(X,{className:"w-4 h-4"}),"Abonnements des Entreprises"]}),e.jsx(V,{className:"text-xs mt-0.5",children:"G√©rez les abonnements et plans des entreprises"})]}),e.jsxs(o,{variant:"outline",size:"sm",onClick:P,className:"h-7 px-2 text-xs",children:[e.jsx(U,{className:"w-3 h-3 mr-1"}),"Actualiser"]})]})}),e.jsx(p,{className:"p-3",children:O?e.jsx("div",{className:"flex items-center justify-center py-8",children:e.jsx(K,{className:"h-6 w-6 animate-spin text-primary"})}):D.length===0?e.jsxs("div",{className:"flex flex-col items-center justify-center py-8 text-center",children:[e.jsx(X,{className:"h-8 w-8 text-muted-foreground mb-2"}),e.jsx("p",{className:"text-sm font-semibold mb-1",children:"Aucune entreprise trouv√©e"})]}):e.jsx("div",{className:"space-y-2",children:D.map(s=>{const a=f[s.id];return e.jsx(h,{className:"hover:shadow-md transition-all",children:e.jsx(p,{className:"pt-3 pb-3 px-3",children:e.jsxs("div",{className:"flex items-center justify-between gap-3",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[s.logo_url&&e.jsx("img",{src:s.logo_url,alt:s.name,className:"w-10 h-10 rounded-lg object-cover border border-gray-200"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"text-sm font-semibold truncate",children:s.name}),a!=null&&a.plan?e.jsxs("div",{className:"flex items-center gap-2 mt-1 flex-wrap",children:[e.jsx(b,{variant:"outline",className:`text-xs ${a.plan.plan_type==="ENTERPRISE"?"border-purple-200 bg-purple-50 text-purple-700":a.plan.plan_type==="PRO"?"border-blue-200 bg-blue-50 text-blue-700":"border-gray-200 bg-gray-50 text-gray-700"}`,children:a.plan.plan_type||"FREEMIUM"}),a.status&&e.jsx(b,{variant:"secondary",className:`text-xs ${a.status==="active"?"bg-[#E8F4F3] text-[#1a5a55] border-[#B8DDD9]":"bg-gray-50 text-gray-700"}`,children:a.status})]}):e.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Aucun abonnement"})]})]}),(a==null?void 0:a.quota_limit)&&e.jsx("div",{className:"text-right text-xs text-muted-foreground",children:e.jsxs("div",{children:["Quota: ",a.quota_used||0,"/",a.quota_limit]})})]})})},s.id)})})})]})]})]})}),l&&e.jsx(Fe,{open:!!l,onOpenChange:s=>!s&&oe(),children:e.jsxs(Me,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(ze,{children:[e.jsxs(Oe,{className:"flex items-center gap-2",children:[e.jsx(C,{className:"w-5 h-5"}),"Fiche Entreprise"]}),e.jsx(qe,{children:"Informations compl√®tes de l'entreprise"})]}),e.jsxs("div",{className:"space-y-6 mt-4",children:[e.jsxs(h,{children:[e.jsx(g,{children:e.jsx(N,{className:"text-base",children:"Informations g√©n√©rales"})}),e.jsx(p,{className:"space-y-4",children:e.jsxs("div",{className:"flex items-start gap-4",children:[l.logo_url&&e.jsx("img",{src:l.logo_url,alt:l.name,className:"w-20 h-20 rounded-lg object-cover border border-gray-200 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Nom de l'entreprise"}),e.jsx("p",{className:"text-base font-semibold",children:l.name})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"RCCM"}),e.jsx("p",{className:"text-sm",children:l.legal_id})]}),l.adresse&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-1 flex items-center gap-1",children:[e.jsx(ts,{className:"w-3 h-3"}),"Adresse"]}),e.jsx("p",{className:"text-sm",children:l.adresse})]}),((de=f[l.id])==null?void 0:de.plan)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Abonnement"}),e.jsx(b,{variant:"outline",className:"text-xs",children:f[l.id].plan.plan_type||"N/A"})]})]})]})})]}),(l.contact_first_name||l.contact_last_name||l.contact_email||l.contact_phone||l.contact_function)&&e.jsxs(h,{children:[e.jsx(g,{children:e.jsxs(N,{className:"text-base flex items-center gap-2",children:[e.jsx($,{className:"w-4 h-4"}),"Contact du r√©f√©rent"]})}),e.jsxs(p,{className:"space-y-3",children:[(l.contact_first_name||l.contact_last_name)&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Nom complet"}),e.jsxs("p",{className:"text-sm font-medium",children:[l.contact_first_name," ",l.contact_last_name]})]}),l.contact_function&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-1 flex items-center gap-1",children:[e.jsx(be,{className:"w-3 h-3"}),"Fonction"]}),e.jsx("p",{className:"text-sm",children:l.contact_function})]}),l.contact_email&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-1 flex items-center gap-1",children:[e.jsx(ye,{className:"w-3 h-3"}),"Email"]}),e.jsx("a",{href:`mailto:${l.contact_email}`,className:"text-sm text-[#226D68] hover:underline",children:l.contact_email})]}),l.contact_phone&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-1 flex items-center gap-1",children:[e.jsx(ve,{className:"w-3 h-3"}),"T√©l√©phone"]}),e.jsx("a",{href:`tel:${l.contact_phone}`,className:"text-sm text-[#226D68] hover:underline",children:l.contact_phone})]})]})]}),e.jsxs(h,{children:[e.jsx(g,{children:e.jsx(N,{className:"text-base",children:"Informations suppl√©mentaires"})}),e.jsxs(p,{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Statut"}),e.jsx(b,{variant:"outline",className:"text-xs",children:l.status||"ACTIVE"})]}),l.created_at&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs text-muted-foreground mb-1 flex items-center gap-1",children:[e.jsx(ge,{className:"w-3 h-3"}),"Date d'inscription"]}),e.jsx("p",{className:"text-sm",children:new Date(l.created_at).toLocaleDateString("fr-FR",{day:"2-digit",month:"long",year:"numeric"})})]}),f[l.id]&&e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Abonnement"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx(b,{variant:"outline",className:`text-xs ${((me=f[l.id].plan)==null?void 0:me.plan_type)==="ENTERPRISE"?"border-purple-200 bg-purple-50 text-purple-700":((xe=f[l.id].plan)==null?void 0:xe.plan_type)==="PRO"?"border-blue-200 bg-blue-50 text-blue-700":"border-gray-200 bg-gray-50 text-gray-700"}`,children:((he=f[l.id].plan)==null?void 0:he.plan_type)||"FREEMIUM"}),f[l.id].status&&e.jsx(b,{variant:"secondary",className:`text-xs ${f[l.id].status==="active"?"bg-[#E8F4F3] text-[#1a5a55] border-[#B8DDD9]":"bg-gray-50 text-gray-700"}`,children:f[l.id].status}),f[l.id].quota_limit&&e.jsxs("p",{className:"text-xs text-muted-foreground mt-1",children:["Quota utilis√©: ",f[l.id].quota_used||0," / ",f[l.id].quota_limit]})]})]})]})]})]}),e.jsx("div",{className:"flex justify-end gap-2 mt-6 pt-4 border-t",children:e.jsx(o,{variant:"outline",onClick:oe,children:"Fermer"})})]})})]})}export{zs as default};
