import{u as A,r as h,j as e,L as f,b as j,d as S}from"./index-Cg1svvI5.js";import{u as E,t as F}from"./types-BlmR3YhF.js";import{B as u}from"./button-wtSf44PI.js";import{I as l}from"./input-j75cJiPX.js";import{L as n}from"./label-CXq0_ejY.js";import{C as b,b as z,c as V,a as B}from"./card-zq6uNjQt.js";import{a as P}from"./auth-CY7Ev4y6.js";import{C as M}from"./check-circle-2-CXExqBjZ.js";import{B as w}from"./building-BYIIU1X8.js";import{A as R}from"./alert-circle-ExmS7pl5.js";import{A as _}from"./arrow-left-B-1lI_0Z.js";import"./index-BktxQI8W.js";function W(){const v=A(),[c,N]=h.useState(null),[r,g]=h.useState(!1),[y,C]=h.useState(!1),X=E({resolver:F(P),defaultValues:{email:"",password:"",confirmPassword:"",firstName:"",lastName:"",companyName:"",companyLegalId:""}}),{register:i,handleSubmit:I,formState:{errors:t}}=X,L=async o=>{try{g(!0),N(null);const m={email:o.email,password:o.password,first_name:o.firstName,last_name:o.lastName,role:"ROLE_COMPANY_ADMIN"},a=await j.register(m),d=await j.getCurrentUser();try{await S.createCompany({name:o.companyName,legal_id:o.companyLegalId,admin_id:d.id})}catch(s){console.warn("Erreur lors de la création de l'entreprise:",s)}C(!0),setTimeout(()=>{v("/company/onboarding")},2e3)}catch(m){console.error("Erreur d'inscription:",m);let a="Une erreur est survenue lors de l'inscription. Veuillez réessayer.";if(m.response){const d=m.response.status,s=m.response.data;if(d===409)a=(s==null?void 0:s.detail)||(s==null?void 0:s.message)||"Un compte avec cet email existe déjà. Veuillez vous connecter ou utiliser un autre email.";else if(d===400)a=(s==null?void 0:s.detail)||(s==null?void 0:s.message)||"Les données fournies sont invalides. Veuillez vérifier vos informations.";else if(d===422){const x=s==null?void 0:s.detail;Array.isArray(x)?a=x.map(p=>p.msg||p.message||String(p)).join(", "):a=x||(s==null?void 0:s.message)||"Les données fournies sont invalides."}else d===500?a="Une erreur serveur est survenue. Veuillez réessayer plus tard.":s!=null&&s.detail?a=s.detail:s!=null&&s.message&&(a=s.message)}else m.message&&(a=m.message);N(a)}finally{g(!1)}};return y?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white flex items-center justify-center p-3 sm:p-4",children:e.jsx(b,{className:"w-full max-w-md rounded-[16px] shadow-xl border-0 overflow-hidden animate-in fade-in zoom-in",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-deep to-blue-deep/90 p-4 sm:p-6 text-white text-center",children:[e.jsx(M,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 animate-in zoom-in"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold font-heading mb-2",children:"Inscription réussie !"}),e.jsx("p",{className:"text-sm sm:text-base text-white/80",children:"Votre compte entreprise a été créé avec succès. Vous allez être redirigé vers la configuration de votre entreprise..."})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white flex items-center justify-center p-3 sm:p-4 md:p-6",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(b,{className:"rounded-[16px] shadow-xl border-0 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-deep to-blue-deep/90 p-4 sm:p-6 text-white",children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center flex-shrink-0",children:e.jsx(w,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(z,{className:"text-xl sm:text-2xl font-bold font-heading text-white truncate",children:"Inscription Entreprise"}),e.jsx(V,{className:"text-white/80 mt-1 text-xs sm:text-sm",children:"Créez votre compte pour accéder à la CVthèque"})]})]})}),e.jsxs(B,{className:"p-4 sm:p-6",children:[e.jsxs("form",{onSubmit:I(L),className:"space-y-4 sm:space-y-5",children:[c&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-800 px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg animate-in slide-in-from-top-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(R,{className:"w-4 h-4 sm:w-5 sm:h-5 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium mb-1",children:c}),c.includes("existe déjà")&&e.jsx(f,{to:"/login",className:"text-xs sm:text-sm text-red-700 hover:text-red-900 underline font-medium",children:"Se connecter avec cet email →"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 sm:gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"firstName",className:"text-sm font-semibold",children:"Prénom *"}),e.jsx(l,{id:"firstName",...i("firstName"),disabled:r,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.firstName&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.firstName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"lastName",className:"text-sm font-semibold",children:"Nom *"}),e.jsx(l,{id:"lastName",...i("lastName"),disabled:r,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.lastName&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.lastName.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"email",className:"text-sm font-semibold",children:"Email professionnel *"}),e.jsx(l,{id:"email",type:"email",placeholder:"contact@entreprise.com",...i("email"),disabled:r,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.email&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"companyName",className:"text-sm font-semibold",children:"Nom de l'entreprise *"}),e.jsx(l,{id:"companyName",placeholder:"Ex: Acme Corp",...i("companyName"),disabled:r,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.companyName&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.companyName.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"companyLegalId",className:"text-sm font-semibold",children:"RCCM *"}),e.jsx(l,{id:"companyLegalId",placeholder:"CI-ABJ-XX-XXXX-BXX-XXXXX",...i("companyLegalId"),disabled:r,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.companyLegalId&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.companyLegalId.message}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"RCCM de votre entreprise (ex. CI-ABJ-XX-XXXX-BXX-XXXXX)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"password",className:"text-sm font-semibold",children:"Mot de passe *"}),e.jsx(l,{id:"password",type:"password",placeholder:"••••••••",...i("password"),disabled:r,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.password&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.password.message}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Minimum 8 caractères"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(n,{htmlFor:"confirmPassword",className:"text-sm font-semibold",children:"Confirmer le mot de passe *"}),e.jsx(l,{id:"confirmPassword",type:"password",placeholder:"••••••••",...i("confirmPassword"),disabled:r,className:"h-10 sm:h-11 text-sm sm:text-base"}),t.confirmPassword&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:t.confirmPassword.message})]}),e.jsx(u,{type:"submit",className:"w-full bg-blue-deep hover:bg-blue-deep/90 text-white h-11 sm:h-12 text-sm sm:text-base font-semibold transition-all duration-200 shadow-md hover:shadow-lg",disabled:r,children:r?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),e.jsx("span",{className:"hidden sm:inline",children:"Inscription en cours..."}),e.jsx("span",{className:"sm:hidden",children:"Inscription..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Créer mon compte entreprise"]})})]}),e.jsxs("div",{className:"mt-5 sm:mt-6 pt-5 sm:pt-6 border-t",children:[e.jsx("p",{className:"text-xs sm:text-sm text-center text-muted-foreground mb-3 sm:mb-4",children:"Vous avez déjà un compte ?"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-2",children:[e.jsx(f,{to:"/login",className:"flex-1",children:e.jsxs(u,{variant:"outline",className:"w-full border-blue-deep text-blue-deep hover:bg-blue-deep/10 h-10 sm:h-11 text-xs sm:text-sm",children:[e.jsx(_,{className:"w-3.5 h-3.5 sm:w-4 sm:h-4 mr-1.5 sm:mr-2"}),"Se connecter"]})}),e.jsx(f,{to:"/register/candidat",className:"flex-1",children:e.jsx(u,{variant:"outline",className:"w-full border-blue-deep text-blue-deep hover:bg-blue-deep/10 h-10 sm:h-11 text-xs sm:text-sm",children:"Inscription Candidat"})})]})]})]})]})})})}export{W as default};
