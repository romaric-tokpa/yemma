import{u as D,e as z,r as i,j as e,L as V,b as q}from"./index-Ck9agymx.js";import{u as A,t as F,o as R,s as w}from"./types-VK2oKv9X.js";import{c as I,B as O}from"./button-DZcKRNoB.js";import{I as g}from"./input-96zCdkwo.js";import{L as j}from"./label-DtEBgE9a.js";import{C as b,b as B,c as H,a as J}from"./card-CYQnxe6u.js";import{C as G}from"./check-circle-2-DmS9kAcz.js";import{L as y}from"./lock-B4910_4k.js";import{A as K}from"./alert-circle-DkTN4TV4.js";import{E as N}from"./eye-D5r6yuIf.js";import{L as Q}from"./loader-2-p7aSMtdV.js";import"./index-CoHPqngH.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v=I("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]),U=R({password:w().min(8,"Le mot de passe doit contenir au moins 8 caractères"),confirmPassword:w().min(8,"La confirmation du mot de passe est requise")}).refine(l=>l.password===l.confirmPassword,{message:"Les mots de passe ne correspondent pas",path:["confirmPassword"]});function ne(){const l=D(),[k]=z(),[h,m]=i.useState(null),[P,C]=i.useState(!1),[o,p]=i.useState(!1),[c,L]=i.useState(!1),[x,S]=i.useState(!1),s=k.get("token"),E=A({resolver:F(U),defaultValues:{password:"",confirmPassword:""}}),{register:u,handleSubmit:M,formState:{errors:d},watch:W}=E;i.useEffect(()=>{s||m("Token de réinitialisation manquant. Veuillez utiliser le lien reçu par email.")},[s]);const T=async a=>{var f;if(!s){m("Token de réinitialisation manquant");return}try{p(!0),m(null),await q.confirmPasswordReset(s,a.password),C(!0),setTimeout(()=>{l("/login",{state:{message:"Votre mot de passe a été modifié avec succès. Vous pouvez maintenant vous connecter."}})},2e3)}catch(n){console.error("Error resetting password:",n);let r="Erreur lors de la réinitialisation du mot de passe. Veuillez réessayer.";if((f=n.response)!=null&&f.data){const t=n.response.data;t.detail?r=typeof t.detail=="string"?t.detail:JSON.stringify(t.detail):t.message&&(r=t.message)}else n.message&&(r=n.message);if(r.includes("HTTPException")&&r.includes("detail=")){const t=r.match(/detail=['"]([^'"]+)['"]/);t&&t[1]&&(r=t[1])}m(r)}finally{p(!1)}};return P?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white flex items-center justify-center p-3 sm:p-4",children:e.jsx(b,{className:"w-full max-w-md rounded-[16px] shadow-xl border-0 overflow-hidden animate-in fade-in zoom-in",children:e.jsxs("div",{className:"p-4 sm:p-6 text-white text-center",style:{background:"linear-gradient(to right, #226D68, #1a5a55)"},children:[e.jsx(G,{className:"w-12 h-12 sm:w-16 sm:h-16 mx-auto mb-3 sm:mb-4 animate-in zoom-in"}),e.jsx("h2",{className:"text-xl sm:text-2xl font-bold font-heading mb-2",children:"Mot de passe modifié avec succès !"}),e.jsx("p",{className:"text-sm sm:text-base text-white/80",children:"Votre mot de passe a été modifié avec succès. Vous allez être redirigé vers la page de connexion..."})]})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-gray-light to-white flex items-center justify-center p-3 sm:p-4 md:p-6",children:e.jsx("div",{className:"w-full max-w-md",children:e.jsxs(b,{className:"rounded-[16px] shadow-xl border-0 overflow-hidden",children:[e.jsx("div",{className:"p-4 sm:p-6 text-white",style:{background:"linear-gradient(to right, #226D68, #1a5a55)"},children:e.jsxs("div",{className:"flex items-center gap-2 sm:gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 sm:w-12 sm:h-12 rounded-full bg-white/20 backdrop-blur-sm flex items-center justify-center flex-shrink-0",children:e.jsx(y,{className:"w-5 h-5 sm:w-6 sm:h-6"})}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx(B,{className:"text-xl sm:text-2xl font-bold font-heading text-white truncate",children:"Définir votre mot de passe"}),e.jsx(H,{className:"text-white/80 mt-1 text-xs sm:text-sm",children:"Entrez votre nouveau mot de passe"})]})]})}),e.jsx(J,{className:"p-4 sm:p-6",children:e.jsxs("form",{onSubmit:M(T),className:"space-y-4 sm:space-y-5",children:[h&&e.jsxs("div",{className:"bg-red-50 border border-red-200 text-red-800 px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg flex items-start gap-2 animate-in slide-in-from-top-2",children:[e.jsx(K,{className:"w-4 h-4 sm:w-5 sm:h-5 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-xs sm:text-sm flex-1",children:h})]}),!s&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 text-yellow-800 px-3 sm:px-4 py-2.5 sm:py-3 rounded-lg text-xs sm:text-sm",children:e.jsx("p",{children:"Token de réinitialisation manquant. Veuillez utiliser le lien reçu par email."})}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"password",className:"text-sm font-semibold",children:"Nouveau mot de passe *"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"password",type:c?"text":"password",placeholder:"••••••••",...u("password"),disabled:o||!s,className:"pr-10 h-10 sm:h-11 text-sm sm:text-base"}),e.jsx("button",{type:"button",onClick:()=>L(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors",disabled:o||!s,children:c?e.jsx(v,{className:"h-4 w-4"}):e.jsx(N,{className:"h-4 w-4"})})]}),d.password&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:d.password.message}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Le mot de passe doit contenir au moins 8 caractères"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{htmlFor:"confirmPassword",className:"text-sm font-semibold",children:"Confirmer le mot de passe *"}),e.jsxs("div",{className:"relative",children:[e.jsx(g,{id:"confirmPassword",type:x?"text":"password",placeholder:"••••••••",...u("confirmPassword"),disabled:o||!s,className:"pr-10 h-10 sm:h-11 text-sm sm:text-base"}),e.jsx("button",{type:"button",onClick:()=>S(!x),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 transition-colors",disabled:o||!s,children:x?e.jsx(v,{className:"h-4 w-4"}):e.jsx(N,{className:"h-4 w-4"})})]}),d.confirmPassword&&e.jsx("p",{className:"text-xs sm:text-sm text-red-600 animate-in fade-in",children:d.confirmPassword.message})]}),e.jsx(O,{type:"submit",className:"w-full text-white h-11 sm:h-12 text-sm sm:text-base font-semibold transition-all duration-200 shadow-md hover:shadow-lg",style:{backgroundColor:"#226D68"},onMouseEnter:a=>{a.currentTarget.style.backgroundColor="#1a5a55"},onMouseLeave:a=>{a.currentTarget.style.backgroundColor="#226D68"},disabled:o||!s,children:o?e.jsxs(e.Fragment,{children:[e.jsx(Q,{className:"w-4 h-4 mr-2 animate-spin"}),e.jsx("span",{className:"hidden sm:inline",children:"Modification en cours..."}),e.jsx("span",{className:"sm:hidden",children:"Modification..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Définir le mot de passe"]})}),e.jsx("div",{className:"text-center pt-2",children:e.jsx(V,{to:"/login",className:"text-xs sm:text-sm hover:underline transition-colors",style:{color:"#226D68"},onMouseEnter:a=>{a.target.style.color="#1a5a55"},onMouseLeave:a=>{a.target.style.color="#226D68"},children:"Retour à la connexion"})})]})})]})})})}export{ne as default};
