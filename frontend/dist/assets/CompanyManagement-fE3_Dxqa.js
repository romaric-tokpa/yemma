import{r as c,j as e,d as R,n as M}from"./index-Cg1svvI5.js";import{T as $,a as O,b as k,c as L}from"./tabs-DacRyiUI.js";import{c as B,B as y}from"./button-wtSf44PI.js";import{C as u,d as H,b as G,a as J}from"./card-zq6uNjQt.js";import{B as N}from"./badge-CBZW5moz.js";import{u as V,t as Z,o as Q,s as F}from"./types-BlmR3YhF.js";import{I as C}from"./input-j75cJiPX.js";import{L as S}from"./label-CXq0_ejY.js";import{D as K,a as W,b as X,c as Y,d as ee}from"./dialog-DPDbtzx5.js";import{U as _}from"./user-plus-DdFknNod.js";import{C as T}from"./check-circle-2-CXExqBjZ.js";import{M as q}from"./mail-BoptD6uC.js";import{L as P}from"./loader-2-DrGK7uFY.js";import{U as se}from"./users-CG471CR-.js";import{S as te}from"./shield-CG62W-kr.js";import{U as ae}from"./user-ILiqHJuw.js";import{C as I}from"./clock-DSejQbFx.js";import{T as re}from"./trash-2-CMMfqTAr.js";import{C as z}from"./calendar-DPHLDLG9.js";import{M as ie}from"./map-pin-BJfi5_gX.js";import{Z as le}from"./zap-DyckASJF.js";import{C as w}from"./check-BqPiqVg8.js";import{F as U}from"./file-text-90F8CKqb.js";import{D as ne}from"./download-jDX2n7X7.js";import"./index-C8kEvNwS.js";import"./index-BktxQI8W.js";import"./index-B1yRHtUD.js";import"./index-BCrHabdb.js";import"./x-DYh5GfAr.js";/**
 * @license lucide-react v0.303.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ce=B("Crown",[["path",{d:"m2 4 3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14",key:"zkxr6b"}]]),oe=Q({first_name:F().min(1,"Le prénom est requis").max(100,"Le prénom est trop long"),last_name:F().min(1,"Le nom est requis").max(100,"Le nom est trop long"),email:F().email("Email invalide").min(1,"L'email est requis"),password:F().min(8,"Le mot de passe doit contenir au moins 8 caractères")});function de({open:r,onOpenChange:d,companyId:a,onSuccess:m}){const[n,o]=c.useState(!1),[g,i]=c.useState(!1),[h,f]=c.useState(null),{register:p,handleSubmit:s,formState:{errors:l},reset:t}=V({resolver:Z(oe)}),x=()=>{n||(t(),i(!1),f(null),d(!1))},j=async D=>{var A;o(!0),f(null);try{await R.inviteMember(a,{email:D.email,first_name:D.first_name,last_name:D.last_name,password:D.password}),i(!0),t(),setTimeout(()=>{x(),m&&m()},2e3)}catch(v){console.error("Error inviting member:",v);let E="Erreur lors de la création du compte";if((A=v.response)!=null&&A.data){const b=v.response.data;b.detail?E=typeof b.detail=="string"?b.detail:JSON.stringify(b.detail):b.message&&(E=b.message)}else v.message&&(E=v.message);f(E)}finally{o(!1)}};return e.jsx(K,{open:r,onOpenChange:x,children:e.jsxs(W,{className:"rounded-[12px] shadow-xl max-w-md",children:[e.jsx(X,{className:"pb-4 border-b",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 bg-[#226D68]/10 rounded-lg",children:e.jsx(_,{className:"h-6 w-6 text-[#226D68]"})}),e.jsxs("div",{children:[e.jsx(Y,{className:"text-2xl font-bold text-gray-anthracite font-heading",children:"Inviter un collaborateur"}),e.jsx(ee,{className:"mt-1 text-muted-foreground",children:"Créez un compte recruteur pour un nouveau membre de l'équipe. Un email lui sera envoyé pour définir son mot de passe."})]})]})}),g?e.jsxs("div",{className:"py-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-[#226D68]/10 rounded-full flex items-center justify-center",children:e.jsx(T,{className:"h-8 w-8 text-[#226D68]"})})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-anthracite mb-2",children:"Compte créé avec succès !"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Le compte recruteur a été créé. Un email avec un lien de réinitialisation de mot de passe a été envoyé. Le lien est valable pendant 24 heures."})]}):e.jsxs("form",{onSubmit:s(j),className:"space-y-5 pt-4",children:[h&&e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-red-600",children:h})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"first_name",className:"text-sm font-medium text-gray-anthracite",children:["Prénom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{id:"first_name",type:"text",placeholder:"Jean",...p("first_name"),className:l.first_name?"border-red-500 focus-visible:ring-red-500":"",disabled:n}),l.first_name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.first_name.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"last_name",className:"text-sm font-medium text-gray-anthracite",children:["Nom ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{id:"last_name",type:"text",placeholder:"Dupont",...p("last_name"),className:l.last_name?"border-red-500 focus-visible:ring-red-500":"",disabled:n}),l.last_name&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.last_name.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"email",className:"text-sm font-medium text-gray-anthracite",children:["Adresse email ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-muted-foreground"}),e.jsx(C,{id:"email",type:"email",placeholder:"collaborateur@example.com",...p("email"),className:`pl-10 rounded-md ${l.email?"border-red-500 focus-visible:ring-red-500":""}`,disabled:n})]}),l.email&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.email.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(S,{htmlFor:"password",className:"text-sm font-medium text-gray-anthracite",children:["Mot de passe temporaire ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(C,{id:"password",type:"password",placeholder:"••••••••",...p("password"),className:l.password?"border-red-500 focus-visible:ring-red-500":"",disabled:n}),l.password&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:l.password.message}),e.jsx("p",{className:"text-xs text-muted-foreground mt-2",children:"Un mot de passe temporaire sera utilisé pour créer le compte. Le collaborateur recevra un email avec un lien pour définir son propre mot de passe."})]}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(y,{type:"button",variant:"outline",onClick:x,disabled:n,className:"border-blue-deep text-blue-deep hover:bg-blue-deep/10",children:"Annuler"}),e.jsx(y,{type:"submit",disabled:n,className:"bg-[#226D68] hover:bg-[#1a5a55] text-white",children:n?e.jsxs(e.Fragment,{children:[e.jsx(P,{className:"h-4 w-4 mr-2 animate-spin"}),"Envoi..."]}):e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Créer le compte"]})})]})]})]})})}function me({companyId:r,onUpdate:d}){const[a,m]=c.useState([]),[n,o]=c.useState(!0),[g,i]=c.useState(!1);c.useEffect(()=>{r&&h()},[r]);const h=async()=>{try{o(!0);const s=await R.getTeamMembers(r);m(s||[])}catch(s){console.error("Error loading team members:",s)}finally{o(!1)}},f=async s=>{if(confirm("Êtes-vous sûr de vouloir supprimer l'accès de ce collaborateur ?"))try{await R.removeTeamMember(r,s),await h(),d&&d()}catch(l){console.error("Error removing team member:",l),alert("Erreur lors de la suppression de l'accès")}},p=()=>{i(!1),h(),d&&d()};return n?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx(P,{className:"h-6 w-6 animate-spin text-[#226D68] mr-2"}),e.jsx("span",{className:"text-muted-foreground",children:"Chargement des membres..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(u,{className:"rounded-[16px] shadow-sm border-l-4 border-l-[#226D68] bg-gradient-to-r from-white to-[#226D68]/5",children:e.jsx(H,{className:"pb-4",children:e.jsxs("div",{className:"flex items-center justify-between flex-wrap gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-gradient-to-br from-[#226D68]/20 to-[#226D68]/10 rounded-xl shadow-sm",children:e.jsx(se,{className:"h-7 w-7 text-[#226D68]"})}),e.jsxs("div",{children:[e.jsx(G,{className:"text-2xl font-bold text-gray-anthracite font-heading mb-1",children:"Membres de l'équipe"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[a.length," ",a.length===1?"membre":"membres"," ",a.length>0&&`• ${a.filter(s=>s.type!=="invitation"&&s.status==="active").length} actif${a.filter(s=>s.type!=="invitation"&&s.status==="active").length>1?"s":""}`]})]})]}),e.jsxs(y,{onClick:()=>i(!0),className:"bg-gradient-to-r from-[#226D68] to-[#1a5a55] hover:from-[#1a5a55] hover:to-[#226D68] text-white shadow-md hover:shadow-lg transition-all duration-200",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Inviter un collaborateur"]})]})})}),a.length===0?e.jsx(u,{className:"rounded-[16px] shadow-sm border-2 border-dashed border-gray-200 p-16 text-center bg-gradient-to-br from-gray-50 to-white",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-[#226D68]/20 to-blue-deep/20 rounded-full flex items-center justify-center mb-6 shadow-inner",children:e.jsx(_,{className:"h-10 w-10 text-[#226D68]"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-anthracite mb-2 font-heading",children:"Aucun membre dans l'équipe"}),e.jsx("p",{className:"text-sm text-muted-foreground mb-8 max-w-md",children:"Commencez par inviter des collaborateurs à rejoindre votre entreprise. Ils recevront un email avec leurs identifiants de connexion."}),e.jsxs(y,{onClick:()=>i(!0),className:"bg-gradient-to-r from-[#226D68] to-[#1a5a55] hover:from-[#1a5a55] hover:to-[#226D68] text-white shadow-md hover:shadow-lg transition-all duration-200 px-6",children:[e.jsx(_,{className:"h-4 w-4 mr-2"}),"Inviter votre premier collaborateur"]})]})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map((s,l)=>e.jsx(u,{className:"rounded-[16px] shadow-sm border border-gray-200 hover:shadow-md transition-all duration-300 hover:border-[#226D68]/30 group overflow-hidden",children:e.jsx(J,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-1 min-w-0",children:[e.jsxs("div",{className:"relative flex-shrink-0",children:[e.jsx("div",{className:"h-16 w-16 rounded-full bg-gradient-to-br from-[#226D68] via-[#1a5a55] to-blue-deep flex items-center justify-center text-white font-bold text-xl shadow-lg ring-4 ring-white",children:s.first_name?s.first_name.charAt(0).toUpperCase():(s.user_email||s.email||"M").charAt(0).toUpperCase()}),s.type!=="invitation"&&s.status==="active"&&e.jsx("div",{className:"absolute bottom-0 right-0 h-5 w-5 bg-[#226D68] rounded-full border-2 border-white flex items-center justify-center",children:e.jsx(T,{className:"h-3 w-3 text-white"})})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-lg text-gray-anthracite font-heading truncate mb-1 group-hover:text-[#226D68] transition-colors",children:s.first_name&&s.last_name?`${s.first_name} ${s.last_name}`:s.email||s.user_email||"Membre"}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[e.jsx(N,{variant:s.role_in_company==="ADMIN_ENTREPRISE"?"default":"secondary",className:`text-xs font-medium px-2.5 py-1 ${s.role_in_company==="ADMIN_ENTREPRISE"?"bg-gradient-to-r from-[#226D68] to-[#1a5a55] text-white border-0 shadow-sm":"bg-blue-deep/10 text-blue-deep border-blue-deep/20"}`,children:s.role_in_company==="ADMIN_ENTREPRISE"?e.jsxs(e.Fragment,{children:[e.jsx(te,{className:"h-3 w-3 mr-1"}),"Administrateur"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"h-3 w-3 mr-1"}),"Recruteur"]})}),s.type==="invitation"?e.jsxs(N,{variant:"outline",className:"text-xs font-medium px-2.5 py-1 text-[#e76f51] border-[#e76f51]/30 bg-[#FDF2F0]/50",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),"En attente"]}):s.status==="active"?e.jsxs(N,{variant:"outline",className:"text-xs font-medium px-2.5 py-1 text-[#226D68] border-[#226D68]/30 bg-[#E8F4F3]/50",children:[e.jsx(T,{className:"h-3 w-3 mr-1"}),"Actif"]}):e.jsxs(N,{variant:"outline",className:"text-xs font-medium px-2.5 py-1 text-[#e76f51] border-[#e76f51]/30 bg-[#FDF2F0]/50",children:[e.jsx(I,{className:"h-3 w-3 mr-1"}),"En attente"]})]})]})]}),s.type!=="invitation"&&s.role_in_company!=="ADMIN_ENTREPRISE"&&e.jsx(y,{variant:"ghost",size:"sm",onClick:()=>f(s.id),className:"flex-shrink-0 h-8 w-8 p-0 text-gray-400 hover:text-red-600 hover:bg-red-50 transition-colors opacity-0 group-hover:opacity-100",title:"Supprimer le membre",children:e.jsx(re,{className:"h-4 w-4"})})]}),e.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(q,{className:"h-4 w-4 text-gray-400 flex-shrink-0"}),e.jsx("span",{className:"text-gray-600 truncate",children:s.email||s.user_email})]}),s.type==="invitation"?e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-gray-600",children:[e.jsx("div",{className:"font-medium",children:"Invité le"}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.created_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}),s.expires_at&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"font-medium mt-1",children:"Expire le"}),e.jsx("div",{className:"text-xs text-[#e76f51]",children:new Date(s.expires_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})})]})]})]}):s.joined_at?e.jsxs("div",{className:"flex items-start gap-2 text-sm",children:[e.jsx(z,{className:"h-4 w-4 text-gray-400 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-gray-600",children:[e.jsx("div",{className:"font-medium",children:"Membre depuis"}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(s.joined_at).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})})]})]}):null]}),s.type==="invitation"&&e.jsx("div",{className:"mt-4 p-3 bg-[#FDF2F0]/50 border border-[#F8D3CA]/50 rounded-lg",children:e.jsx("p",{className:"text-xs text-[#c04a2f] font-medium",children:"En attente de réponse de l'invité"})})]})})},`${s.type}-${s.id}`))}),e.jsx(de,{open:g,onOpenChange:i,companyId:r,onSuccess:p})]})}function xe({companyId:r,onUpdate:d}){const[a,m]=c.useState(null),[n,o]=c.useState([]),[g,i]=c.useState(!0);c.useEffect(()=>{r&&(h(),f())},[r]);const h=async()=>{try{const t=await M.getCompanySubscription(r);m(t)}catch(t){console.error("Error loading subscription:",t)}finally{i(!1)}},f=async()=>{try{const t=await M.getPlans();console.log("Plans chargés depuis l'API:",t);const x=t.filter(j=>j.plan_type!=="FREEMIUM");console.log("Plans filtrés (sans FREEMIUM):",x),o(x)}catch(t){console.error("Error loading plans:",t)}},p=async(t,x="monthly")=>{try{const j=await M.createCheckoutSession({company_id:r,plan_id:t,billing_period:x});window.location.href=j.url}catch(j){console.error("Error creating checkout session:",j),alert("Erreur lors de la création de la session de paiement")}};if(g)return e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Chargement..."});const s=(a==null?void 0:a.plan)||{plan_type:"FREEMIUM",name:"Gratuit"},l=s.plan_type==="FREEMIUM";return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Abonnement"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gérez votre plan d'abonnement et accédez à plus de fonctionnalités"})]}),e.jsx(u,{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"text-xl font-semibold",children:"Plan actuel"}),e.jsx(N,{variant:l?"secondary":"default",children:s.name})]}),e.jsxs("p",{className:"text-gray-600",children:[(a==null?void 0:a.status)==="active"?"Abonnement actif":"Plan gratuit",(a==null?void 0:a.current_period_end)&&e.jsxs("span",{className:"ml-2",children:["• Renouvellement le ",new Date(a.current_period_end).toLocaleDateString("fr-FR")]})]})]})})}),l&&e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-6",children:"Passer au plan supérieur"}),e.jsx("div",{className:"grid md:grid-cols-2 gap-6",children:[...n].sort((t,x)=>t.name==="Essentiel"?-1:x.name==="Essentiel"?1:0).map(t=>e.jsxs(u,{className:`p-6 relative transition-all hover:shadow-lg ${t.plan_type==="ENTERPRISE"?"border-2 border-yellow-400":t.name==="Essentiel"?"border-2 border-[#226D68]":""}`,children:[t.name==="Essentiel"&&e.jsxs("div",{className:"absolute top-4 right-4 flex items-center gap-1",children:[e.jsx(ie,{className:"h-5 w-5 text-[#226D68]"}),e.jsx(N,{className:"bg-[#226D68] text-white text-xs",children:"Côte d'Ivoire"})]}),t.plan_type==="ENTERPRISE"&&t.name!=="Essentiel"&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(ce,{className:"h-6 w-6 text-yellow-500 fill-yellow-500"})}),t.plan_type==="PRO"&&t.name!=="Essentiel"&&e.jsx("div",{className:"absolute top-4 right-4",children:e.jsx(le,{className:"h-6 w-6 text-blue-500 fill-blue-500"})}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-2xl font-bold mb-2 text-gray-900",children:t.name}),t.name==="Essentiel"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[e.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:[Math.round(t.price_monthly*655).toLocaleString("fr-FR")," FCFA"]}),e.jsx("span",{className:"text-gray-600 text-lg",children:"/mois"})]}),t.price_yearly&&e.jsxs("p",{className:"text-sm text-gray-600",children:["ou ",e.jsxs("span",{className:"font-semibold",children:[Math.round(t.price_yearly*655).toLocaleString("fr-FR")," FCFA/an"]}),e.jsxs("span",{className:"text-[#226D68] ml-2",children:["(économisez ",((t.price_monthly*12-t.price_yearly)/(t.price_monthly*12)*100).toFixed(0),"%)"]})]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["(≈ ",t.price_monthly.toFixed(2),"€/mois)"]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-baseline gap-2 mb-2",children:[e.jsxs("span",{className:"text-4xl font-bold text-gray-900",children:[t.price_monthly.toFixed(2),"€"]}),e.jsx("span",{className:"text-gray-600 text-lg",children:"/mois"})]}),t.price_yearly&&e.jsxs("p",{className:"text-sm text-gray-600",children:["ou ",e.jsxs("span",{className:"font-semibold",children:[t.price_yearly.toFixed(2),"€/an"]}),e.jsxs("span",{className:"text-[#226D68] ml-2",children:["(économisez ",((t.price_monthly*12-t.price_yearly)/(t.price_monthly*12)*100).toFixed(0),"%)"]})]})]})]}),e.jsxs("ul",{className:"space-y-3 mb-6",children:[t.unlimited_search&&e.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(w,{className:"h-5 w-5 text-[#226D68] flex-shrink-0"}),e.jsx("span",{children:"Recherche illimitée"})]}),t.max_profile_views===null?e.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(w,{className:"h-5 w-5 text-[#226D68] flex-shrink-0"}),e.jsx("span",{children:"Consultations illimitées"})]}):e.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(w,{className:"h-5 w-5 text-[#226D68] flex-shrink-0"}),e.jsxs("span",{children:[t.max_profile_views," consultations/mois"]})]}),t.document_access&&e.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(w,{className:"h-5 w-5 text-[#226D68] flex-shrink-0"}),e.jsx("span",{children:"Accès aux documents"})]}),t.multi_accounts&&e.jsxs("li",{className:"flex items-center gap-2 text-sm text-gray-700",children:[e.jsx(w,{className:"h-5 w-5 text-[#226D68] flex-shrink-0"}),e.jsx("span",{children:"Multi-comptes recruteurs"})]})]}),e.jsx(y,{className:"w-full",size:"lg",onClick:()=>p(t.id,"monthly"),variant:t.name==="Essentiel"?"default":"outline",children:t.name==="Essentiel"?"Choisir ce plan":"Passer au plan supérieur"})]},t.id))})]}),!l&&a&&e.jsxs(u,{className:"p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Détails de l'abonnement"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Statut"}),e.jsx("p",{className:"font-semibold capitalize",children:a.status})]}),a.current_period_start&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Période actuelle"}),e.jsxs("p",{className:"font-semibold",children:[new Date(a.current_period_start).toLocaleDateString("fr-FR")," - ",new Date(a.current_period_end).toLocaleDateString("fr-FR")]})]}),a.quota_limit!==null&&e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600",children:"Quota utilisé"}),e.jsxs("p",{className:"font-semibold",children:[a.quota_used||0," / ",a.quota_limit||"∞"]})]})]})]})]})}function he({companyId:r}){const[d,a]=c.useState([]),[m,n]=c.useState(!0);c.useEffect(()=>{r&&o()},[r]);const o=async()=>{try{const i=await M.getInvoices(r);a(i)}catch(i){console.error("Error loading invoices:",i)}finally{n(!1)}},g=i=>{i.pdf_url?window.open(i.pdf_url,"_blank"):alert("Le PDF de la facture n'est pas encore disponible")};return m?e.jsx("div",{className:"text-center py-8 text-gray-500",children:"Chargement..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold",children:"Historique des factures"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Consultez et téléchargez vos factures"})]}),d.length===0?e.jsxs(u,{className:"p-8 text-center",children:[e.jsx(U,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Aucune facture disponible"})]}):e.jsx(u,{children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Numéro"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Montant"}),e.jsx("th",{className:"px-6 py-4 text-left text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Statut"}),e.jsx("th",{className:"px-6 py-4 text-right text-xs font-semibold text-gray-700 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(i=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(U,{className:"h-5 w-5 text-gray-400 mr-2"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:i.invoice_number})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(i.invoice_date).toLocaleDateString("fr-FR",{year:"numeric",month:"long",day:"numeric"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("div",{className:"text-sm font-semibold text-gray-900",children:[i.total_amount.toFixed(2),"€"]}),i.tax_amount>0&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["dont TVA: ",i.tax_amount.toFixed(2),"€"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx(N,{variant:"default",className:"bg-[#D1E9E7] text-[#1a5a55] border-[#B8DDD9]",children:"Payée"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs(y,{variant:"outline",size:"sm",onClick:()=>g(i),className:"hover:bg-gray-100",children:[e.jsx(ne,{className:"h-4 w-4 mr-2"}),"Télécharger"]})})]},i.id))})]})})})]})}function Be(){const[r,d]=c.useState(null),[a,m]=c.useState(!0);c.useEffect(()=>{n()},[]);const n=async()=>{try{const o=await R.getMyCompany();d(o)}catch(o){console.error("Error loading company:",o)}finally{m(!1)}};return a?e.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-light",children:e.jsxs("div",{className:"text-center",children:[e.jsx(P,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-[#226D68]"}),e.jsx("p",{className:"text-muted-foreground",children:"Chargement..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-light p-3 sm:p-4 md:p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-anthracite font-heading mb-2",children:"Gestion de l'entreprise"}),e.jsx("p",{className:"text-sm sm:text-base text-muted-foreground",children:"Gérez votre équipe, votre abonnement et consultez l'historique"})]}),e.jsxs($,{defaultValue:"team",className:"w-full",children:[e.jsx("div",{className:"overflow-x-auto -mx-3 sm:mx-0 px-3 sm:px-0",children:e.jsxs(O,{className:"grid w-full grid-cols-3 bg-white border rounded-lg p-1 min-w-max sm:min-w-0",children:[e.jsx(k,{value:"team",className:"data-[state=active]:bg-[#226D68] data-[state=active]:text-white rounded-md text-xs sm:text-sm px-3 sm:px-4 py-2 sm:py-2.5 whitespace-nowrap",children:"Équipe"}),e.jsx(k,{value:"subscription",className:"data-[state=active]:bg-[#226D68] data-[state=active]:text-white rounded-md text-xs sm:text-sm px-3 sm:px-4 py-2 sm:py-2.5 whitespace-nowrap",children:"Abonnement"}),e.jsx(k,{value:"history",className:"data-[state=active]:bg-[#226D68] data-[state=active]:text-white rounded-md text-xs sm:text-sm px-3 sm:px-4 py-2 sm:py-2.5 whitespace-nowrap",children:"Historique"})]})}),e.jsx(L,{value:"team",className:"mt-4 sm:mt-6",children:e.jsx(me,{companyId:r==null?void 0:r.id,onUpdate:n})}),e.jsx(L,{value:"subscription",className:"mt-4 sm:mt-6",children:e.jsx(xe,{companyId:r==null?void 0:r.id,onUpdate:n})}),e.jsx(L,{value:"history",className:"mt-4 sm:mt-6",children:e.jsx(he,{companyId:r==null?void 0:r.id})})]})]})})}export{Be as default};
