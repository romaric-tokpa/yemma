# ============================================
# ENVIRONMENT CONFIGURATION
# ============================================
APP_ENV=development
DEBUG=true
LOG_LEVEL=DEBUG

# ============================================
# DATABASE CONFIGURATION
# ============================================
# Utilisées par docker-compose (postgres) et auth-service
# Pour migrations locales : DB_HOST=localhost, DB_PORT=5433 (port exposé Docker)
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=yemma_db
DB_PORT=5433

# Auth Service Database (legacy / optionnel)
DB_AUTH_USER=auth_user
DB_AUTH_PASSWORD=change_me_auth_password_123
DB_AUTH_NAME=auth_db
DB_AUTH_PORT=5432

# Candidate Service Database
DB_CANDIDATE_USER=candidate_user
DB_CANDIDATE_PASSWORD=change_me_candidate_password_123
DB_CANDIDATE_NAME=candidate_db
DB_CANDIDATE_PORT=5433

# Admin Service Database
DB_ADMIN_USER=admin_user
DB_ADMIN_PASSWORD=change_me_admin_password_123
DB_ADMIN_NAME=admin_db
DB_ADMIN_PORT=5434

# ============================================
# JWT & SECURITY
# ============================================
# ⚠️ IMPORTANT: Change these values in production!
# Generate a secure secret key: openssl rand -hex 32
JWT_SECRET_KEY=your-super-secret-jwt-key-change-in-production-min-32-chars
JWT_ALGORITHM=HS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7

OAUTH2_SECRET_KEY=your-oauth2-secret-key-change-in-production
PASSWORD_HASH_ALGORITHM=bcrypt

# OAuth Google & LinkedIn (optionnel - vide = boutons désactivés côté backend)
# Google: https://console.cloud.google.com/apis/credentials → Créer des identifiants OAuth 2.0
# LinkedIn: https://www.linkedin.com/developers/apps → Sign In with LinkedIn
GOOGLE_CLIENT_ID=
GOOGLE_CLIENT_SECRET=
LINKEDIN_CLIENT_ID=
LINKEDIN_CLIENT_SECRET=
# URL publique du service auth (pour redirect_uri OAuth). Ex: http://localhost:8001
AUTH_SERVICE_EXTERNAL_URL=

# ============================================
# INTERNAL SERVICE AUTHENTICATION
# ============================================
# Secret partagé pour signer les tokens JWT inter-services
# ⚠️ IMPORTANT: Doit être identique dans TOUS les services!
# Generate a secure secret key: openssl rand -hex 64
INTERNAL_SERVICE_TOKEN_SECRET=yemma-internal-service-secret-key-change-in-production-min-64-chars-12345678901234567890123456789012

# ============================================
# NGINX GATEWAY
# ============================================
# Ports du Gateway Nginx (seul point d'entrée)
# Hostinger : par défaut 8080/8443 (port 80 souvent occupé par Apache)
# Local : mettre 80/443 pour accès direct
NGINX_HTTP_PORT=8080
NGINX_HTTPS_PORT=8443

# URL du frontend (pour liens de réinitialisation mot de passe, invitations, etc.)
FRONTEND_URL=http://localhost:3000

# Proxy Vite en dev (optionnel). Par défaut : nginx sur 8080.
# Pour reset-password : démarrer nginx+auth+postgres puis accéder à http://localhost:3000/reset-password
# Ou avec auth seul (sans nginx) : VITE_AUTH_API_URL=http://localhost:8001
VITE_PROXY_TARGET=http://localhost:8080
# Admin (évaluation/validation) : pointe directement vers le service admin si 502 via nginx
VITE_ADMIN_PROXY_TARGET=http://localhost:8009

# ============================================
# RABBITMQ CONFIGURATION
# ============================================
RABBITMQ_USER=rabbitmq
RABBITMQ_PASSWORD=change_me_rabbitmq_password_123
RABBITMQ_VHOST=yemma
RABBITMQ_PORT=5672
RABBITMQ_MANAGEMENT_PORT=15672

# ============================================
# MINIO / S3 CONFIGURATION
# ============================================
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=change_me_minio_password_123
MINIO_API_PORT=9000
MINIO_CONSOLE_PORT=9001

S3_BUCKET_NAME=documents
S3_REGION=us-east-1
S3_USE_SSL=false
# Server-Side Encryption (AES256 pour MinIO, aws:kms pour AWS S3)
S3_SERVER_SIDE_ENCRYPTION=AES256
# KMS Key ID (uniquement si S3_SERVER_SIDE_ENCRYPTION=aws:kms)
# S3_KMS_KEY_ID=arn:aws:kms:us-east-1:123456789012:key/12345678-1234-1234-1234-123456789012

# ============================================
# DOCUMENT SERVICE CONFIGURATION
# ============================================
MAX_FILE_SIZE=10485760
ALLOWED_EXTENSIONS=pdf,jpg,jpeg,png,doc,docx
ENCRYPTION_KEY=your-encryption-key-32-chars-long-12345678901234567890123456789012
TEMP_LINK_EXPIRE_HOURS=24

# Antivirus (optional)
ENABLE_ANTIVIRUS=false
CLAMAV_HOST=clamav
CLAMAV_PORT=3310

# ============================================
# SMTP / EMAIL (Notification Service)
# ============================================
# Pour les emails réels (reset password, inscriptions, etc.)
# Sans SMTP : les emails sont sauvegardés dans ./yemma_emails/ (mode mock)
# Gmail : créer un "Mot de passe d'application" dans Sécurité Google
EMAIL_PROVIDER=fastapi_mail
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USE_TLS=true
SMTP_USER=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=noreply@yemma.com
SMTP_FROM_NAME=Yemma Solutions
# SMTP_TIMEOUT=15  # Timeout connexion SMTP (secondes, défaut 15)

# ============================================
# PAYMENT / STRIPE (service payment)
# ============================================
STRIPE_SECRET_KEY=sk_test_...
STRIPE_PUBLISHABLE_KEY=pk_test_...
STRIPE_WEBHOOK_SECRET=whsec_...
# Jours d'essai gratuit avant facturation automatique (0 = pas d'essai)
TRIAL_DAYS=3

# ============================================
# SERVICE PORTS
# ============================================
AUTH_SERVICE_PORT=8001
CANDIDATE_SERVICE_PORT=8002
ADMIN_SERVICE_PORT=8003
DOCUMENT_SERVICE_PORT=8004
NOTIFICATION_PORT=8007

# ============================================
# SERVICE URLS (Internal)
# ============================================
# Utilisé par le service candidat pour envoyer les emails (soumission profil, etc.)
# Local : http://localhost:8007   Docker : http://notification:8000
NOTIFICATION_SERVICE_URL=http://localhost:8007

# These are used for inter-service communication (Docker)
AUTH_SERVICE_URL=http://auth-service:8000
CANDIDATE_SERVICE_URL=http://candidate-service:8000
ADMIN_SERVICE_URL=http://admin-service:8000
DOCUMENT_SERVICE_URL=http://document-service:8000

# ============================================
# HRFLOW.AI - Parsing CV + Profile Asking (CvGPT)
# ============================================
# Créer un workspace sur https://hrflow.ai, activer Profile Parsing et Profile Asking.
# - Parsing : utilisé par yemma-parsing-service pour parser les CV et indexer les profils.
# - Profile Asking (CvGPT) : utilisé par le service admin pour l'analyse IA dans l'onglet Évaluation.
#   Clé API : format askw_xxx (Profile Asking) ou la clé standard du workspace.
#   HRFLOW_USER_EMAIL : email du compte HrFlow (souvent requis pour Profile Asking).
HRFLOW_API_KEY=your-hrflow-api-key
HRFLOW_USER_EMAIL=your-email@example.com
HRFLOW_SOURCE_KEY=ae16505f6f0eebe3abb79ad1bf83ec53b4886432
HRFLOW_API_URL=https://api.hrflow.ai/v1

# Port du service parsing
PARSING_PORT=8010

# ============================================
# FRONTEND ENVIRONMENT VARIABLES
# ============================================
# Variables d'environnement pour le frontend (Vite). Préfixe requis : VITE_
# Base URL uniquement (sans chemin) : le frontend appelle /api/v1/profiles/me, /api/v1/auth/login, etc.
# - Derrière Nginx (prod / dev gateway) : laisser vide '' ou mettre l'origine (ex. http://localhost)
# - Dev sans gateway (frontend :3000, services :8001, :8002...) : utiliser les ports directs ci-dessous
VITE_API_BASE_URL=http://localhost
VITE_AUTH_API_URL=http://localhost:8001
VITE_CANDIDATE_API_URL=http://localhost:8002
VITE_DOCUMENT_API_URL=http://localhost:8003
VITE_SEARCH_API_URL=http://localhost:8004
VITE_COMPANY_API_URL=http://localhost:8005
VITE_PAYMENT_API_URL=http://localhost:8006
# Proxy Vite : redirection directe vers le service payment en dev (évite 404 si nginx/payment non démarrés)
# VITE_PAYMENT_PROXY_TARGET=http://localhost:8006
VITE_NOTIFICATION_API_URL=http://localhost:8007
VITE_AUDIT_API_URL=http://localhost:8008
VITE_ADMIN_API_URL=http://localhost:8009
VITE_PARSING_API_URL=http://localhost:8010
VITE_FRONTEND_URL=http://localhost:3000

# ============================================
# EXTERNAL SERVICE URLS (if needed)
# ============================================
# For services that need to call other services from outside Docker network
# AUTH_SERVICE_EXTERNAL_URL=http://localhost:8001
# CANDIDATE_SERVICE_EXTERNAL_URL=http://localhost:8002
# ADMIN_SERVICE_EXTERNAL_URL=http://localhost:8003

# Super Admin (créé au démarrage du service auth)
# SUPER_ADMIN_EMAIL=admin@yemma.com
# SUPER_ADMIN_PASSWORD=12345678
# DOCUMENT_SERVICE_EXTERNAL_URL=http://localhost:8004

